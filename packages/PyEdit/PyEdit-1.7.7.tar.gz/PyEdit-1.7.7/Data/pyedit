#! /usr/bin/env python3
import os, sys

fd = str("/".join(__file__.split("/")[:-1]))
if fd[0] == "." and fd[1] == "/":
  fd = fd[2:]

fd = fd.replace(os.getcwd(), "")
vs = sys.version_info
m, n = vs.major, vs.minor

if os.path.exists("/usr/include/python{m}.{n}m".format(m=m,n=n)):
  mi = "m"
elif os.path.exists("/usr/include/python{m}.{n}".format(m=m, n=n)):
  mi = ""

#print(os.path.exists("/usr/include/python{m}.{n}"))

comm = 'gcc -Os -I /usr/include/python{m}.{n} PyEdit.c -lpython{m}.{n}{mi} -o ./pyedit'.format(m=m,n=n, mi=mi)

os.chdir(fd)
os.remove(__file__.split("/")[-1])

os.system(comm)
print(comm)
os.remove("PyEdit.c")
os.system("./pyedit")