(self.webpackChunk_jlab_enhanced_cell_toolbar=self.webpackChunk_jlab_enhanced_cell_toolbar||[]).push([[791],{791:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>x});var n=s(227),a=s(753),o=s(802),i=s(510),l=s(343),d=s(850);class c extends i.Widget{constructor(t,e){super(),this._commands=t,this._items=e,this.layout=new i.PanelLayout,this.addClass("jp-enh-cell-menu"),this._itemsChanged(e),this._items.changed.connect(this._itemsChanged,this)}dispose(){this.isDisposed||(this._items.changed.disconnect(this._itemsChanged,this),super.dispose())}_itemsChanged(t,e){(0,d.each)(this.children(),(t=>{t.dispose()}));const s=this.layout;(0,d.each)(t.iter(),(t=>{this._commands.hasCommand(t.command)&&s.addWidget(new l.ToolbarButton({icon:o.LabIcon.resolve({icon:t.icon}),className:`jp-enh-cell-${t.cellType||"all"}`,onClick:()=>{this._commands.execute(t.command)},tooltip:t.tooltip||this._commands.label(t.command)}))}))}}var h=s(669);class r extends i.Widget{constructor(t,e){super(),this._model=t,this._tagList=e,this.layout=new i.PanelLayout,this.addClass("jp-enh-cell-tags"),this._createTagInput(),e.changed.connect(this.onTagListChanged,this);const s=t.metadata.get("tags")||[];s.length>0?e.pushAll(s):this.refreshTags(),t.metadata.changed.connect(this.onCellMetadataChanged,this)}dispose(){this.isDisposed||(this._model.metadata.changed.disconnect(this.onCellMetadataChanged,this),this._tagList.changed.disconnect(this.onTagListChanged,this),super.dispose())}checkApplied(t){return(this._model.metadata.get("tags")||[]).some((e=>e===t))}addTag(t){const e=this._model.metadata.get("tags")||[],s=t.split(/[,\s]+/).filter((t=>""!==t&&!e.includes(t)));this._model.metadata.set("tags",[...e,...s])}removeTag(t){const e=[...this._model.metadata.get("tags")||[]],s=e.indexOf(t);s>-1&&e.splice(s,1),0===e.length?this._model.metadata.delete("tags"):this._model.metadata.set("tags",e)}refreshTags(){const t=this.layout,e=[...new Set((0,d.toArray)(this._tagList))],s=[...e].sort(((t,e)=>t>e?1:-1)),n=new Array;t.widgets.forEach((t=>{if("add-tag"!==t.id){const s=e.indexOf(t.name);s<0?n.push(t):e.splice(s,1)}})),n.forEach((t=>t.dispose())),e.forEach((e=>{t.insertWidget(this.layout.widgets.length-1,new h.TagWidget(e))})),t.widgets.forEach((t=>{t.update()})),[...t.widgets].forEach(((e,n)=>{let a=s.findIndex((t=>e.name===t));-1===a&&(a=s.length),a!==n&&t.insertWidget(a,e)}))}_createTagInput(){const t=this.layout,e=new h.AddWidget;e.id="add-tag",t.addWidget(e)}_validateTags(t){const e=new Set;return t.filter((t=>"string"==typeof t&&""!==t)).forEach((t=>{t.split(/[,\s]+/).forEach((t=>{""!==t&&e.add(t)}))})),[...e]}onCellMetadataChanged(t,e){if("tags"===e.key){const t=[...new Set(e.oldValue||[])],s=this._validateTags(e.newValue||[]);t.forEach((t=>{s.includes(t)||this._tagList.removeValue(t)})),this._tagList.pushAll(s.filter((e=>!t.includes(e))))}}onTagListChanged(t,e){this.refreshTags()}}class g extends i.Widget{constructor(t,e,s,n,a,o=0){super(),this.layout=new i.PanelLayout,this.addClass("jp-enh-cell-toolbar");const l=new i.Widget;l.addClass("jp-enh-cell-left-space"),l.node.style.width=`${o}px`,this.layout.addWidget(l),this.layout.addWidget(new c(t,n)),this.layout.addWidget(new r(e,s)),this.layout.addWidget(new c(t,a))}}const m="@jlab-enhanced/cell-toolbar",p=new o.LabIcon({name:`${m}:code`,svgstr:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16px" height="16px">\n    <path d="M0 0h24v24H0V0z" fill="none" />\n    <path class="jp-icon3" fill="#626262" d="M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z" />\n</svg>'}),u=new o.LabIcon({name:`${m}:delete`,svgstr:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16px" height="16px">\n    <path d="M0 0h24v24H0z" fill="none" />\n    <path class="jp-icon3" fill="#626262" d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z" />\n</svg>'}),_=new o.LabIcon({name:`${m}:format`,svgstr:'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" focusable="false" width="16px"\n    height="16px" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);"\n    preserveAspectRatio="xMidYMid meet" viewBox="0 0 1792 1792">\n    <path class="jp-icon3"\n        d="M1473 929q7-118-33-226.5t-113-189t-177-131T929 325q-116-7-225.5 32t-192 110.5t-135 175T317 863q-7 118 33 226.5t113 189t177.5 131T862 1467q155 9 293-59t224-195.5t94-283.5zM1792 0l-349 348q120 117 180.5 272t50.5 321q-11 183-102 339t-241 255.5T999 1660L0 1792l347-347q-120-116-180.5-271.5T116 852q11-184 102-340t241.5-255.5T792 132q167-22 500-66t500-66z"\n        fill="#626262" />\n</svg>'});class f extends i.Widget{constructor(t){super({node:w.createNode(t)}),this.addClass("jp-enh-cell-button"),this._callback=t.callback}handleEvent(t){switch(t.type){case"mousedown":this._evtMouseDown(t)}}onBeforeAttach(t){this.node.addEventListener("mousedown",this)}onAfterDetach(t){this.node.removeEventListener("mousedown",this)}_evtMouseDown(t){0===t.button&&(t.preventDefault(),t.stopPropagation(),this._callback())}}var w;!function(t){t.createNode=function(t){const e=document.createElement("button");return t.tooltip&&(e.title=t.tooltip),t.className&&e.classList.add(t.className),e.appendChild(o.LabIcon.resolve({icon:t.icon}).element({elementPosition:"center",elementSize:"normal",tag:"span"})),e}}(w||(w={}));const v=[{cellType:"markdown",command:"notebook:change-cell-to-code",icon:p},{cellType:"code",command:"notebook:change-cell-to-markdown",icon:o.markdownIcon},{cellType:"code",command:"jupyterlab_code_formatter:format",icon:_,tooltip:"Format Cell"},{command:"notebook:delete-cell",icon:u}],b=[{command:"notebook:run-cell-and-select-next",icon:o.runIcon},{command:"notebook:move-cell-up",icon:o.caretUpEmptyThinIcon},{command:"notebook:move-cell-down",icon:o.caretDownEmptyThinIcon},{command:"notebook:insert-cell-below",icon:o.addIcon}],y="jp-enh-cell-bar";class T{constructor(t,e,s){this._allTags=new a.ObservableList,this._isDisposed=!1,this._leftMenuItems=new a.ObservableList,this._previousDefaultTags=new Array,this._rightMenuItems=new a.ObservableList,this._commands=e,this._panel=t,this._settings=s,this._settings&&(this._onSettingsChanged(),this._settings.changed.connect(this._onSettingsChanged,this)),this._panel.context.model.cells.changed.connect(this.updateConnectedCells,this)}get isDisposed(){return this._isDisposed}dispose(){var t;if(this.isDisposed)return;this._isDisposed=!0,this._settings&&this._settings.changed.disconnect(this._onSettingsChanged,this);const e=null===(t=this._panel)||void 0===t?void 0:t.context.model.cells;e&&e.changed.disconnect(this.updateConnectedCells,this),this._panel=null}updateConnectedCells(t,e){e.oldValues.forEach((t=>this._removeToolbar(t))),e.newValues.forEach((t=>this._addToolbar(t)))}_addToolbar(t){var e;const s=this._getCell(t);if(s){const n=new g(this._commands,t,this._allTags,this._leftMenuItems,this._rightMenuItems,(null===(e=this._settings)||void 0===e?void 0:e.composite.leftSpace)||0);n.addClass(y),s.layout.insertWidget(0,n),b.forEach((t=>{if(this._commands.hasCommand(t.command)){const{cellType:e,command:n,tooltip:a}=t,o=function(t,e){var s={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(s[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(t);a<n.length;a++)e.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(t,n[a])&&(s[n[a]]=t[n[a]])}return s}(t,["cellType","command","tooltip"]),i=n.split(":")[1],l=new f(Object.assign(Object.assign({},o),{callback:()=>{this._commands.execute(n)},className:i&&`jp-enh-cell-${i}`,tooltip:a||this._commands.label(t.command)}));l.addClass(y),l.addClass(`jp-enh-cell-${e||"all"}`),s.layout.addWidget(l)}}))}}_getCell(t){var e;return null===(e=this._panel)||void 0===e?void 0:e.content.widgets.find((e=>e.model===t))}_findToolbarWidgets(t){return t.layout.widgets.filter((t=>t.hasClass(y)))||[]}_removeToolbar(t){const e=this._getCell(t);e&&this._findToolbarWidgets(e).forEach((t=>t.dispose()))}_onSettingsChanged(){var t,e,s,n;const a=null===(t=this._settings)||void 0===t?void 0:t.composite.leftMenu;this._leftMenuItems.length>0&&this._leftMenuItems.clear(),a?a.length>0&&this._leftMenuItems.pushAll(a):this._leftMenuItems.pushAll(v);const o=(null===(e=this._settings)||void 0===e?void 0:e.composite.rightMenu)||[];this._rightMenuItems.length>0&&this._rightMenuItems.clear(),o.length>0&&this._rightMenuItems.pushAll(o);const i=(null===(s=this._settings)||void 0===s?void 0:s.composite.defaultTags)||[],l=i.filter((t=>!this._previousDefaultTags.includes(t)));l.length>0&&this._allTags.pushAll(l),this._previousDefaultTags.filter((t=>!i.includes(t))).forEach((t=>this._allTags.removeValue(t))),this._previousDefaultTags=i;const d=(null===(n=this._settings)||void 0===n?void 0:n.composite.leftSpace)||0;this._panel&&this._panel.node.querySelectorAll("div.jp-enh-cell-left-space").forEach((t=>{t.style.width=`${d}px`}))}}class C{constructor(t,e){this._commands=t,this._settings=e}createNew(t){return new T(t,this._commands,this._settings)}}const x={id:`${m}:plugin`,autoStart:!0,activate:async(t,e)=>{var s;const n=null!==(s=await(null==e?void 0:e.load(`${m}:plugin`)))&&void 0!==s?s:null;t.docRegistry.addWidgetExtension("Notebook",new C(t.commands,n))},optional:[n.ISettingRegistry]}}}]);