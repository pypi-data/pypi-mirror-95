

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>macsypy.config &mdash; MacSyFinder 2.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> MacSyFinder
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../user_guide/index.html">User Guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../modeler_guide/index.html">Modeller Guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../developer_guide/index.html">Developer Guide</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">MacSyFinder</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
      <li>macsypy.config</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for macsypy.config</h1><div class="highlight"><pre>
<span></span><span class="c1">#########################################################################</span>
<span class="c1"># MacSyFinder - Detection of macromolecular systems in protein dataset  #</span>
<span class="c1">#               using systems modelling and similarity search.          #</span>
<span class="c1"># Authors: Sophie Abby, Bertrand Neron                                  #</span>
<span class="c1"># Copyright (c) 2014-2021  Institut Pasteur (Paris) and CNRS.           #</span>
<span class="c1"># See the COPYRIGHT file for details                                    #</span>
<span class="c1">#                                                                       #</span>
<span class="c1"># This file is part of MacSyFinder package.                             #</span>
<span class="c1">#                                                                       #</span>
<span class="c1"># MacSyFinder is free software: you can redistribute it and/or modify   #</span>
<span class="c1"># it under the terms of the GNU General Public License as published by  #</span>
<span class="c1"># the Free Software Foundation, either version 3 of the License, or     #</span>
<span class="c1"># (at your option) any later version.                                   #</span>
<span class="c1">#                                                                       #</span>
<span class="c1"># MacSyFinder is distributed in the hope that it will be useful,        #</span>
<span class="c1"># but WITHOUT ANY WARRANTY; without even the implied warranty of        #</span>
<span class="c1"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the          #</span>
<span class="c1"># GNU General Public License for more details .                         #</span>
<span class="c1">#                                                                       #</span>
<span class="c1"># You should have received a copy of the GNU General Public License     #</span>
<span class="c1"># along with MacSyFinder (COPYING).                                     #</span>
<span class="c1"># If not, see &lt;https://www.gnu.org/licenses/&gt;.                          #</span>
<span class="c1">#########################################################################</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">strftime</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">from</span> <span class="nn">configparser</span> <span class="kn">import</span> <span class="n">ConfigParser</span><span class="p">,</span> <span class="n">ParsingError</span><span class="p">,</span> <span class="n">NoSectionError</span>

<span class="kn">from</span> <span class="nn">macsypy</span> <span class="kn">import</span> <span class="n">__MACSY_CONF__</span><span class="p">,</span> <span class="n">__MACSY_DATA__</span>
<span class="kn">from</span>  <span class="nn">macsypy.model_conf_parser</span> <span class="kn">import</span> <span class="n">ModelConfParser</span>
<span class="n">_log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>


<div class="viewcode-block" id="MacsyDefaults"><a class="viewcode-back" href="../../developer_guide/api/config.html#macsypy.config.MacsyDefaults">[docs]</a><span class="k">class</span> <span class="nc">MacsyDefaults</span><span class="p">(</span><span class="nb">dict</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handle all default values for macsyfinder.</span>
<span class="sd">    the default values must be defined here, **NOT** in argument parser nor in config</span>
<span class="sd">    the argument parser or config must use a MacsyDefaults object</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="MacsyDefaults.__init__"><a class="viewcode-back" href="../../developer_guide/api/config.html#macsypy.config.MacsyDefaults.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param kwargs: allow to overwrite a default value.</span>
<span class="sd">                       It mainly used in unit tests</span>

<span class="sd">        To define a new default value just add an attribute with the default value</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">if</span> <span class="n">__MACSY_DATA__</span> <span class="o">==</span> <span class="s1">&#39;$&#39;</span> <span class="o">+</span> <span class="s1">&#39;MACSYDATA&#39;</span><span class="p">:</span>
            <span class="n">prefix_data</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> <span class="s1">&#39;..&#39;</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">prefix_data</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">__MACSY_DATA__</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cfg_file</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;cfg_file&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coverage_profile</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;coverage_profile&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">e_value_search</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;e_value_search&#39;</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">no_cut_ga</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;no_cut_ga&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">db_type</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;db_type&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hmmer</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;hmmer&#39;</span><span class="p">,</span> <span class="s1">&#39;hmmsearch&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">i_evalue_sel</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;i_evalue_sel&#39;</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">idx</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;idx&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inter_gene_max_space</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;inter_gene_max_space&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log_level</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;log_level&#39;</span><span class="p">,</span> <span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log_file</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;log_file&#39;</span><span class="p">,</span> <span class="s1">&#39;macsyfinder.log&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_nb_genes</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;max_nb_genes&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_genes_required</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;min_genes_required&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_mandatory_genes_required</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;min_mandatory_genes_required&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">models</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;models&#39;</span><span class="p">,</span> <span class="p">[])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">models_dir</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;models_dir&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">prefix_data</span><span class="p">,</span> <span class="s1">&#39;models&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">multi_loci</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;multi_loci&#39;</span><span class="p">,</span> <span class="nb">set</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mute</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;mute&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">out_dir</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;out_dir&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">previous_run</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;previous_run&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">profile_suffix</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;profile_suffix&#39;</span><span class="p">,</span> <span class="s1">&#39;.hmm&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">quiet</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;quiet&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relative_path</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;relative_path&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">replicon_topology</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;replicon_topology&#39;</span><span class="p">,</span> <span class="s1">&#39;circular&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">res_extract_suffix</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;res_extract_suffix&#39;</span><span class="p">,</span> <span class="s1">&#39;.res_hmm_extract&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">res_search_dir</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;res_search_dir&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">res_search_suffix</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;res_search_suffix&#39;</span><span class="p">,</span> <span class="s1">&#39;.search_hmm.out&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sequence_db</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;sequence_db&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">topology_file</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;topology_file&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;verbosity&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">worker</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;worker&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mandatory_weight</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;mandatory_weight&#39;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">accessory_weight</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;accessory_weight&#39;</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">neutral_weight</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;neutral_weight&#39;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exchangeable_weight</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;exchangeable_weight&#39;</span><span class="p">,</span> <span class="o">.</span><span class="mi">8</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loner_multi_system_weight</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;loner_multi_system_weight&#39;</span><span class="p">,</span> <span class="o">.</span><span class="mi">7</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">itself_weight</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;itself_weight&#39;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">redundancy_penalty</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;redundancy_penalty&#39;</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="Config"><a class="viewcode-back" href="../../developer_guide/api/config.html#macsypy.config.Config">[docs]</a><span class="k">class</span> <span class="nc">Config</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handle configuration values for macsyfinder.</span>
<span class="sd">    This values come from default and ar superseded by the configuration files, then the command line settings.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">cfg_opts</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;base&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;db_type&#39;</span><span class="p">,</span> <span class="s1">&#39;idx&#39;</span><span class="p">,</span> <span class="s1">&#39;replicon_topology&#39;</span><span class="p">,</span> <span class="s1">&#39;sequence_db&#39;</span><span class="p">,</span> <span class="s1">&#39;topology_file&#39;</span><span class="p">)),</span>
                <span class="p">(</span><span class="s1">&#39;models_opt&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;inter_gene_max_space&#39;</span><span class="p">,</span> <span class="s1">&#39;max_nb_genes&#39;</span><span class="p">,</span> <span class="s1">&#39;min_mandatory_genes_required&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;min_genes_required&#39;</span><span class="p">,</span> <span class="s1">&#39;multi_loci&#39;</span><span class="p">)),</span>
                <span class="p">(</span><span class="s1">&#39;models&#39;</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">()),</span>
                <span class="p">(</span><span class="s1">&#39;hmmer&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;coverage_profile&#39;</span><span class="p">,</span> <span class="s1">&#39;e_value_search&#39;</span><span class="p">,</span> <span class="s1">&#39;no_cut_ga&#39;</span><span class="p">,</span> <span class="s1">&#39;i_evalue_sel&#39;</span><span class="p">,</span> <span class="s1">&#39;hmmer&#39;</span><span class="p">)),</span>
                <span class="p">(</span><span class="s1">&#39;score_opt&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;mandatory_weight&#39;</span><span class="p">,</span> <span class="s1">&#39;accessory_weight&#39;</span><span class="p">,</span> <span class="s1">&#39;neutral_weight&#39;</span><span class="p">,</span> <span class="s1">&#39;exchangeable_weight&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;itself_weight&#39;</span><span class="p">,</span> <span class="s1">&#39;redundancy_penalty&#39;</span><span class="p">,</span> <span class="s1">&#39;loner_multi_system_weight&#39;</span><span class="p">)),</span>
                <span class="p">(</span><span class="s1">&#39;directories&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;models_dir&#39;</span><span class="p">,</span> <span class="s1">&#39;out_dir&#39;</span><span class="p">,</span> <span class="s1">&#39;profile_suffix&#39;</span><span class="p">,</span> <span class="s1">&#39;res_search_dir&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;res_search_suffix&#39;</span><span class="p">,</span> <span class="s1">&#39;res_extract_suffix&#39;</span><span class="p">)),</span>
                <span class="p">(</span><span class="s1">&#39;general&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;cfg_file&#39;</span><span class="p">,</span> <span class="s1">&#39;log_file&#39;</span><span class="p">,</span> <span class="s1">&#39;log_level&#39;</span><span class="p">,</span> <span class="s1">&#39;previous_run&#39;</span><span class="p">,</span> <span class="s1">&#39;relative_path&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;verbosity&#39;</span><span class="p">,</span> <span class="s1">&#39;quiet&#39;</span><span class="p">,</span> <span class="s1">&#39;mute&#39;</span><span class="p">,</span> <span class="s1">&#39;worker&#39;</span><span class="p">)),</span>
                <span class="p">]</span>

    <span class="n">model_opts</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;itself&#39;</span><span class="p">,</span> <span class="s1">&#39;exchangeable&#39;</span><span class="p">,</span> <span class="s1">&#39;mandatory&#39;</span><span class="p">,</span> <span class="s1">&#39;accessory&#39;</span><span class="p">,</span> <span class="s1">&#39;neutral&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;loner_multi_system&#39;</span><span class="p">,</span> <span class="s1">&#39;redundancy_penalty&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;e_value_search&#39;</span><span class="p">,</span> <span class="s1">&#39;e_value_sel&#39;</span><span class="p">,</span> <span class="s1">&#39;coverage_profile&#39;</span><span class="p">,</span> <span class="s1">&#39;cut_ga&#39;</span><span class="p">)</span>


<div class="viewcode-block" id="Config.__init__"><a class="viewcode-back" href="../../developer_guide/api/config.html#macsypy.config.Config.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">defaults</span><span class="p">,</span> <span class="n">parsed_args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Store macsyfinder configuration options and propose an interface to access to them.</span>

<span class="sd">        The config object is populated in several steps, the rules of precedence are</span>

<span class="sd">        system wide conf &lt; user home conf &lt; model conf &lt; (project conf | previous run) &lt; command line</span>

<span class="sd">        system wide conf = etc/macsyfinder/macsyfinder.conf</span>
<span class="sd">        user home conf = ~/.macsyfinder/macsyfinder.conf</span>
<span class="sd">        model conf = model_conf.xml at the root of the model package</span>
<span class="sd">        project conf = macsyfinder.conf  where the analysis is run</span>
<span class="sd">        previous run = macsyfinder.conf in previous run results dir</span>
<span class="sd">        command line = the options set on the command line</span>

<span class="sd">        :param defaults:</span>
<span class="sd">        :type defaults: a :class:`MacsyDefaults` object</span>
<span class="sd">        :param parsed_args: the command line arguments parsed</span>
<span class="sd">        :type parsed_args: a :class:`argspace.Namescape` object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cfg_name</span> <span class="o">=</span> <span class="s2">&quot;macsyfinder.conf&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_defaults</span> <span class="o">=</span> <span class="n">defaults</span>

        <span class="k">if</span> <span class="n">__MACSY_DATA__</span> <span class="o">==</span> <span class="s1">&#39;$&#39;</span> <span class="o">+</span> <span class="s1">&#39;MACSYDATA&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_prefix_data</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> <span class="s1">&#39;..&#39;</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_prefix_data</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">__MACSY_DATA__</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">__MACSY_CONF__</span> <span class="o">==</span> <span class="s1">&#39;$&#39;</span> <span class="o">+</span> <span class="s1">&#39;MACSYCONF&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_conf_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> <span class="s1">&#39;..&#39;</span><span class="p">,</span> <span class="s1">&#39;etc&#39;</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_conf_dir</span> <span class="o">=</span> <span class="n">__MACSY_CONF__</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_options</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tmp_opts</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_set_default_config</span><span class="p">()</span>

        <span class="n">system_wide_config_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_conf_dir</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">system_wide_config_file</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_set_system_wide_config</span><span class="p">(</span><span class="n">system_wide_config_file</span><span class="p">)</span>

        <span class="n">user_wide_config_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">&#39;~&#39;</span><span class="p">),</span> <span class="s1">&#39;.macsyfinder&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">user_wide_config_file</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_set_user_wide_config</span><span class="p">(</span><span class="n">user_wide_config_file</span><span class="p">)</span>

        <span class="n">project_config_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="s1">&#39;macsyfinder.conf&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">project_config_file</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_set_project_config_file</span><span class="p">(</span><span class="n">project_config_file</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">parsed_args</span><span class="p">,</span> <span class="s1">&#39;cfg_file&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">parsed_args</span><span class="o">.</span><span class="n">cfg_file</span><span class="p">:</span>
            <span class="n">user_config_file</span> <span class="o">=</span> <span class="n">parsed_args</span><span class="o">.</span><span class="n">cfg_file</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">user_config_file</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_set_user_config_file</span><span class="p">(</span><span class="n">user_config_file</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Config file </span><span class="si">{</span><span class="n">user_config_file</span><span class="si">}</span><span class="s2"> not found.&quot;</span><span class="p">)</span>

        <span class="n">previous_run</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">parsed_args</span><span class="p">,</span> <span class="s1">&#39;previous_run&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">parsed_args</span><span class="o">.</span><span class="n">previous_run</span><span class="p">:</span>
            <span class="n">prev_config</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">parsed_args</span><span class="o">.</span><span class="n">previous_run</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg_name</span><span class="p">))</span>
            <span class="n">previous_run</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">prev_config</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No config file found in dir </span><span class="si">{</span><span class="n">parsed_args</span><span class="o">.</span><span class="n">previous_run</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_set_previous_run_config</span><span class="p">(</span><span class="n">prev_config</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">previous_run</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">parsed_args</span><span class="p">,</span> <span class="s1">&#39;sequence_db&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">parsed_args</span><span class="o">.</span><span class="n">sequence_db</span><span class="p">:</span>
                <span class="n">_log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ignore sequence_db &#39;</span><span class="si">{</span><span class="n">parsed_args</span><span class="o">.</span><span class="n">sequence_db</span><span class="si">}</span><span class="s2">&#39; use sequence_db &quot;</span>
                             <span class="sa">f</span><span class="s2">&quot;from previous_run &#39;</span><span class="si">{</span><span class="n">parsed_args</span><span class="o">.</span><span class="n">previous_run</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">)</span>
                <span class="n">parsed_args</span><span class="o">.</span><span class="n">sequence_db</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_set_command_line_config</span><span class="p">(</span><span class="n">parsed_args</span><span class="p">)</span>

        <span class="n">models</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">models</span><span class="p">:</span>
            <span class="c1"># the config is also used for macsydata</span>
            <span class="c1"># in this case the models are not necessary</span>
            <span class="n">model_family_root</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">models</span>
            <span class="n">models_config_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">models_dir</span><span class="p">(),</span> <span class="n">model_family_root</span><span class="p">,</span> <span class="s1">&#39;model_conf.xml&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">models_config_file</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_set_model_config</span><span class="p">(</span><span class="n">models_config_file</span><span class="p">)</span>

        <span class="c1"># superseed options (potentially in model_conf)</span>
        <span class="c1"># by the values provided by previous-run, project conf, the users on the commandline</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_tmp_opts</span><span class="p">)</span></div>


<div class="viewcode-block" id="Config._set_options"><a class="viewcode-back" href="../../developer_guide/api/config.html#macsypy.config.Config._set_options">[docs]</a>    <span class="k">def</span> <span class="nf">_set_options</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">options</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        set key, value in the general config</span>

<span class="sd">        :param options: the options to specify in general config</span>
<span class="sd">        :type options: a dictionary with option name as keys and values as values</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">opt</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">options</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">met_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;_set_</span><span class="si">{</span><span class="n">opt</span><span class="si">}</span><span class="s1">&#39;</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">met_name</span><span class="p">):</span>
                    <span class="c1"># config has a specific method to parse and store the value</span>
                    <span class="c1"># for this option</span>
                    <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">met_name</span><span class="p">)(</span><span class="n">val</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># config has no method defined to set this option</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="p">[</span><span class="n">opt</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span></div>


<div class="viewcode-block" id="Config._set_default_config"><a class="viewcode-back" href="../../developer_guide/api/config.html#macsypy.config.Config._set_default_config">[docs]</a>    <span class="k">def</span> <span class="nf">_set_default_config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        set the value comming from MacsyDefaults</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># the special methods are not used to fill with defaults values</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_options</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_defaults</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span></div>


<div class="viewcode-block" id="Config._set_system_wide_config"><a class="viewcode-back" href="../../developer_guide/api/config.html#macsypy.config.Config._set_system_wide_config">[docs]</a>    <span class="k">def</span> <span class="nf">_set_system_wide_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config_path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        set the options from the system wide configuration file</span>

<span class="sd">        :param str config_path:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">system_wide_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_config_file_2_dict</span><span class="p">(</span><span class="n">config_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_options</span><span class="p">(</span><span class="n">system_wide_config</span><span class="p">)</span></div>


<div class="viewcode-block" id="Config._set_user_wide_config"><a class="viewcode-back" href="../../developer_guide/api/config.html#macsypy.config.Config._set_user_wide_config">[docs]</a>    <span class="k">def</span> <span class="nf">_set_user_wide_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config_path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the options from the ~/.macsyfinder/macsyfinder.conf file</span>

<span class="sd">        :param str config_path: The path to the ~/.macsyfinder/macsyfinder.conf</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">user_wide_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_config_file_2_dict</span><span class="p">(</span><span class="n">config_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_options</span><span class="p">(</span><span class="n">user_wide_config</span><span class="p">)</span></div>


<div class="viewcode-block" id="Config._set_model_config"><a class="viewcode-back" href="../../developer_guide/api/config.html#macsypy.config.Config._set_model_config">[docs]</a>    <span class="k">def</span> <span class="nf">_set_model_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_conf_path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the options from the model package model_conf.xml file</span>

<span class="sd">        :param str model_conf_path: The path to the model_conf.xml file</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">mp</span> <span class="o">=</span> <span class="n">ModelConfParser</span><span class="p">(</span><span class="n">model_conf_path</span><span class="p">)</span>
        <span class="n">model_conf</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">parse</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_set_options</span><span class="p">(</span><span class="n">model_conf</span><span class="p">)</span></div>


<div class="viewcode-block" id="Config._set_project_config_file"><a class="viewcode-back" href="../../developer_guide/api/config.html#macsypy.config.Config._set_project_config_file">[docs]</a>    <span class="k">def</span> <span class="nf">_set_project_config_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config_path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the options from the macsyfinder.conf present in the current directory</span>

<span class="sd">        :param str config_path: the path to the configuration file</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">project_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_config_file_2_dict</span><span class="p">(</span><span class="n">config_path</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">opt</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_opts</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">opt</span> <span class="ow">in</span> <span class="n">project_config</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_tmp_opts</span><span class="p">[</span><span class="n">opt</span><span class="p">]</span> <span class="o">=</span> <span class="n">project_config</span><span class="p">[</span><span class="n">opt</span><span class="p">]</span>
                <span class="k">del</span><span class="p">(</span><span class="n">project_config</span><span class="p">[</span><span class="n">opt</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_options</span><span class="p">(</span><span class="n">project_config</span><span class="p">)</span></div>


<div class="viewcode-block" id="Config._set_user_config_file"><a class="viewcode-back" href="../../developer_guide/api/config.html#macsypy.config.Config._set_user_config_file">[docs]</a>    <span class="k">def</span> <span class="nf">_set_user_config_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config_path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the options specified by the user on the command line via the --cfg-file option</span>

<span class="sd">        :param str config_path: The path to the configuration path</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">user_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_config_file_2_dict</span><span class="p">(</span><span class="n">config_path</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">opt</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_opts</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">opt</span> <span class="ow">in</span> <span class="n">user_config</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_tmp_opts</span><span class="p">[</span><span class="n">opt</span><span class="p">]</span> <span class="o">=</span> <span class="n">user_config</span><span class="p">[</span><span class="n">opt</span><span class="p">]</span>
                <span class="k">del</span> <span class="p">(</span><span class="n">user_config</span><span class="p">[</span><span class="n">opt</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_options</span><span class="p">(</span><span class="n">user_config</span><span class="p">)</span></div>

<div class="viewcode-block" id="Config._set_previous_run_config"><a class="viewcode-back" href="../../developer_guide/api/config.html#macsypy.config.Config._set_previous_run_config">[docs]</a>    <span class="k">def</span> <span class="nf">_set_previous_run_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prev_config_path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the options specified by the user on the command line via --previous-run</span>

<span class="sd">        :param prev_config_path:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">previous_conf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_config_file_2_dict</span><span class="p">(</span><span class="n">prev_config_path</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;out_dir&#39;</span> <span class="ow">in</span> <span class="n">previous_conf</span><span class="p">:</span>
            <span class="c1"># set the out_dir from the previous_run is a non sense</span>
            <span class="k">del</span><span class="p">(</span><span class="n">previous_conf</span><span class="p">[</span><span class="s1">&#39;out_dir&#39;</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">opt</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_opts</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">opt</span> <span class="ow">in</span> <span class="n">previous_conf</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_tmp_opts</span><span class="p">[</span><span class="n">opt</span><span class="p">]</span> <span class="o">=</span> <span class="n">previous_conf</span><span class="p">[</span><span class="n">opt</span><span class="p">]</span>
                <span class="k">del</span> <span class="p">(</span><span class="n">previous_conf</span><span class="p">[</span><span class="n">opt</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_options</span><span class="p">(</span><span class="n">previous_conf</span><span class="p">)</span></div>


<div class="viewcode-block" id="Config._set_command_line_config"><a class="viewcode-back" href="../../developer_guide/api/config.html#macsypy.config.Config._set_command_line_config">[docs]</a>    <span class="k">def</span> <span class="nf">_set_command_line_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parsed_args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        :param parsed_args: the argument set on the command line</span>
<span class="sd">        :type parsed_args: :class:`argparse.Namespace` object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># do not iter on args special attribute</span>
        <span class="c1"># do not set option if the value is None (not specified on command line)</span>
        <span class="n">args_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">vars</span><span class="p">(</span><span class="n">parsed_args</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">k</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;__&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">}</span>
        <span class="k">for</span> <span class="n">opt</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_opts</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">opt</span> <span class="ow">in</span> <span class="n">args_dict</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_tmp_opts</span><span class="p">[</span><span class="n">opt</span><span class="p">]</span> <span class="o">=</span> <span class="n">args_dict</span><span class="p">[</span><span class="n">opt</span><span class="p">]</span>
                <span class="k">del</span> <span class="p">(</span><span class="n">args_dict</span><span class="p">[</span><span class="n">opt</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_options</span><span class="p">(</span><span class="n">args_dict</span><span class="p">)</span></div>


<div class="viewcode-block" id="Config._config_file_2_dict"><a class="viewcode-back" href="../../developer_guide/api/config.html#macsypy.config.Config._config_file_2_dict">[docs]</a>    <span class="k">def</span> <span class="nf">_config_file_2_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parse a configuration file in ini format in dictionnary</span>

<span class="sd">        :param str file: path to the configuartion file</span>
<span class="sd">        :return: the parsed options</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parser</span> <span class="o">=</span> <span class="n">ConfigParser</span><span class="p">()</span>
        <span class="n">parse_meth</span> <span class="o">=</span> <span class="p">{</span><span class="nb">int</span><span class="p">:</span> <span class="n">parser</span><span class="o">.</span><span class="n">getint</span><span class="p">,</span>
                      <span class="nb">float</span><span class="p">:</span> <span class="n">parser</span><span class="o">.</span><span class="n">getfloat</span><span class="p">,</span>
                      <span class="nb">bool</span><span class="p">:</span> <span class="n">parser</span><span class="o">.</span><span class="n">getboolean</span>
                      <span class="p">}</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">parser</span><span class="o">.</span><span class="n">read</span><span class="p">([</span><span class="n">file</span><span class="p">])</span>
            <span class="n">_log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Configuration file </span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="s2"> parsed.&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">ParsingError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ParsingError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The macsyfinder configuration file &#39;</span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="s2">&#39; is not well formed: </span><span class="si">{</span><span class="n">err</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="kn">from</span> <span class="bp">None</span>
        <span class="n">opts</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">sections</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">parser</span><span class="o">.</span><span class="n">sections</span><span class="p">()]</span>

        <span class="k">for</span> <span class="n">section</span> <span class="ow">in</span> <span class="n">sections</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">option</span> <span class="ow">in</span> <span class="n">parser</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="n">section</span><span class="p">):</span>
                <span class="n">opt_type</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_defaults</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">option</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">opt_value</span> <span class="o">=</span> <span class="n">parse_meth</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">opt_type</span><span class="p">,</span> <span class="n">parser</span><span class="o">.</span><span class="n">get</span><span class="p">)(</span><span class="n">section</span><span class="p">,</span> <span class="n">option</span><span class="p">)</span>
                <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">)</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid value in config_file for option &#39;</span><span class="si">{</span><span class="n">option</span><span class="si">}</span><span class="s2">&#39;: </span><span class="si">{</span><span class="n">err</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">opts</span><span class="p">[</span><span class="n">option</span><span class="p">]</span> <span class="o">=</span> <span class="n">opt_value</span>
        <span class="k">return</span> <span class="n">opts</span></div>


    <span class="k">def</span> <span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">option_name</span><span class="p">):</span>
        <span class="c1"># some getter return just a value they can be transformed in property</span>
        <span class="c1"># but some other need extra argument so they cannot be a property, they must be methods</span>
        <span class="c1"># to have something generic and with the same behavior</span>
        <span class="c1"># that mean need to call all of them</span>
        <span class="c1"># for generic getter, that mean no code in config</span>
        <span class="c1"># I simulate a function (lambda) which can be called without argument</span>
        <span class="k">if</span> <span class="n">option_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="p">:</span>
            <span class="k">return</span> <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="p">[</span><span class="n">option_name</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;config object has no attribute &#39;</span><span class="si">{</span><span class="n">option_name</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>


<div class="viewcode-block" id="Config._str_2_tuple"><a class="viewcode-back" href="../../developer_guide/api/config.html#macsypy.config.Config._str_2_tuple">[docs]</a>    <span class="k">def</span> <span class="nf">_str_2_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        transform a string with syntax {model_fqn int} in list of tuple</span>

<span class="sd">        :param str value: the string to parse</span>
<span class="sd">        :return:</span>
<span class="sd">        :rtype: [(model_fqn, int), ...]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">it</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
            <span class="n">res</span> <span class="o">=</span> <span class="p">[(</span><span class="n">a</span><span class="p">,</span> <span class="nb">next</span><span class="p">(</span><span class="n">it</span><span class="p">))</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">it</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">res</span>
        <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;You must provide a list of model name and value separated by spaces: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="Config.save"><a class="viewcode-back" href="../../developer_guide/api/config.html#macsypy.config.Config.save">[docs]</a>    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path_or_buf</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        save itself in a file in ini format.</span>

<span class="sd">        .. note::</span>
<span class="sd">            the undefined options (set to None) are omitted</span>

<span class="sd">        :param path_or_buf: where to serialize itself.</span>
<span class="sd">        :type path_or_buf: str or file like object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">def</span> <span class="nf">serialize</span><span class="p">():</span>
            <span class="n">conf_str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="k">for</span> <span class="n">section</span><span class="p">,</span> <span class="n">options</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg_opts</span><span class="p">:</span>
                <span class="n">conf_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="n">section</span><span class="si">}</span><span class="s2">]</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="k">if</span> <span class="n">section</span> <span class="o">==</span> <span class="s1">&#39;models&#39;</span><span class="p">:</span>
                    <span class="c1"># [(model_family, (def_name1, ...)), ... ]</span>
                    <span class="n">model_family</span><span class="p">,</span> <span class="n">model_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">()</span>
                    <span class="n">conf_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;models = </span><span class="si">{</span><span class="n">model_family</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">model_names</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">opt</span> <span class="ow">in</span> <span class="n">options</span><span class="p">:</span>
                        <span class="n">opt_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="p">[</span><span class="n">opt</span><span class="p">]</span>
                        <span class="k">if</span> <span class="n">opt_value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="k">continue</span>
                        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">opt_value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                            <span class="n">value</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                            <span class="k">for</span> <span class="n">model</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">opt_value</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                                <span class="n">value</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">model</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2"> &quot;</span>
                            <span class="n">opt_value</span> <span class="o">=</span> <span class="n">value</span>
                        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">opt_value</span><span class="p">,</span> <span class="nb">set</span><span class="p">):</span>
                            <span class="n">opt_value</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">opt_value</span><span class="p">)</span>
                        <span class="n">conf_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">opt</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">opt_value</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="k">return</span> <span class="n">conf_str</span>

        <span class="k">if</span> <span class="n">path_or_buf</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">path_or_buf</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">out_dir</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">path_or_buf</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path_or_buf</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">cfg_file</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">serialize</span><span class="p">(),</span> <span class="n">file</span><span class="o">=</span><span class="n">cfg_file</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">serialize</span><span class="p">(),</span> <span class="n">file</span><span class="o">=</span><span class="n">path_or_buf</span><span class="p">)</span></div>


<div class="viewcode-block" id="Config._set_db_type"><a class="viewcode-back" href="../../developer_guide/api/config.html#macsypy.config.Config._set_db_type">[docs]</a>    <span class="k">def</span> <span class="nf">_set_db_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        set value for &#39;db_type&#39; option</span>

<span class="sd">        :param str value: the value for db_type, allowed values are :</span>
<span class="sd">                          &#39;ordered_replicon&#39;, &#39;gembase&#39;, &#39;unordered&#39;</span>
<span class="sd">        :raise ValueError: if value is not allowed</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">auth_values</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;ordered_replicon&#39;</span><span class="p">,</span> <span class="s1">&#39;gembase&#39;</span><span class="p">,</span> <span class="s1">&#39;unordered&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">auth_values</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="p">[</span><span class="s1">&#39;db_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;db_type as unauthorized value : &#39;</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="Config._set_inter_gene_max_space"><a class="viewcode-back" href="../../developer_guide/api/config.html#macsypy.config.Config._set_inter_gene_max_space">[docs]</a>    <span class="k">def</span> <span class="nf">_set_inter_gene_max_space</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        set value for &#39;inter_gene_max_space&#39; option</span>

<span class="sd">        :param str value: the string parse representing the model fully qualified name</span>
<span class="sd">                          and it&#39;s associated value and so on</span>
<span class="sd">                          the model_fqn is a string, the associated value must be cast in int</span>
<span class="sd">        :raise ValueError: if value is not well formed</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">opt</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_str_2_tuple</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid syntax for &#39;inter_gene_max_space&#39;: </span><span class="si">{</span><span class="n">err</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">model_fqn</span><span class="p">,</span> <span class="n">quorum</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">opt</span><span class="p">[</span><span class="n">model_fqn</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">quorum</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The value for &#39;inter_gene_max_space&#39; option for model </span><span class="si">{</span><span class="n">model_fqn</span><span class="si">}</span><span class="s2"> must be an integer&quot;</span>
                                 <span class="sa">f</span><span class="s2">&quot;, but you provided </span><span class="si">{</span><span class="n">quorum</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="p">[</span><span class="s1">&#39;inter_gene_max_space&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">opt</span></div>


<div class="viewcode-block" id="Config.inter_gene_max_space"><a class="viewcode-back" href="../../developer_guide/api/config.html#macsypy.config.Config.inter_gene_max_space">[docs]</a>    <span class="k">def</span> <span class="nf">inter_gene_max_space</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_fqn</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param str model_fqn: the model fully qualifed name</span>
<span class="sd">        :return: the gene_max_space for the model_fqn or None if it&#39;s does not specify</span>
<span class="sd">        :rtype: int or None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="p">[</span><span class="s1">&#39;inter_gene_max_space&#39;</span><span class="p">]:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="p">[</span><span class="s1">&#39;inter_gene_max_space&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">model_fqn</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="Config._set_max_nb_genes"><a class="viewcode-back" href="../../developer_guide/api/config.html#macsypy.config.Config._set_max_nb_genes">[docs]</a>    <span class="k">def</span> <span class="nf">_set_max_nb_genes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        set value for &#39;max_nb_genes&#39; option</span>

<span class="sd">        :param str value: the string parse representing the model fully qualified name</span>
<span class="sd">                          and it&#39;s associated value and so on</span>
<span class="sd">                          the model_fqn is a string, the associated value must be cast in int</span>
<span class="sd">        :raise ValueError: if value is not well formed</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">opt</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_str_2_tuple</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid syntax for &#39;max_nb_genes&#39;: </span><span class="si">{</span><span class="n">err</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">model_fqn</span><span class="p">,</span> <span class="n">quorum</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">opt</span><span class="p">[</span><span class="n">model_fqn</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">quorum</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The value for &#39;max_nb_genes&#39; option for model </span><span class="si">{</span><span class="n">model_fqn</span><span class="si">}</span><span class="s2"> must be an integer, &quot;</span>
                                 <span class="sa">f</span><span class="s2">&quot;but you provided </span><span class="si">{</span><span class="n">quorum</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="p">[</span><span class="s1">&#39;max_nb_genes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">opt</span></div>


<div class="viewcode-block" id="Config.max_nb_genes"><a class="viewcode-back" href="../../developer_guide/api/config.html#macsypy.config.Config.max_nb_genes">[docs]</a>    <span class="k">def</span> <span class="nf">max_nb_genes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_fqn</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param str model_fqn: the model fully qualifed name</span>
<span class="sd">        :return: the max_nb_genes for the model_fqn or None if it&#39;s does not specify</span>
<span class="sd">        :rtype: int or None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="p">[</span><span class="s1">&#39;max_nb_genes&#39;</span><span class="p">]:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="p">[</span><span class="s1">&#39;max_nb_genes&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">model_fqn</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="Config._set_min_genes_required"><a class="viewcode-back" href="../../developer_guide/api/config.html#macsypy.config.Config._set_min_genes_required">[docs]</a>    <span class="k">def</span> <span class="nf">_set_min_genes_required</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        set value for &#39;min_genes_required&#39; option</span>

<span class="sd">        :param str value: the string parse representing the model fully qualified name</span>
<span class="sd">                          and it&#39;s associated value and so on</span>
<span class="sd">                          the model_fqn is a string, the associated value must be cast in int</span>
<span class="sd">        :raise ValueError: if value is not well formed</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">opt</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_str_2_tuple</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid syntax for &#39;min_genes_required&#39;: </span><span class="si">{</span><span class="n">err</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">model_fqn</span><span class="p">,</span> <span class="n">quorum</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">opt</span><span class="p">[</span><span class="n">model_fqn</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">quorum</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The value for &#39;min_genes_required&#39; option for model </span><span class="si">{</span><span class="n">model_fqn</span><span class="si">}</span><span class="s2"> must be an integer, &quot;</span>
                                 <span class="sa">f</span><span class="s2">&quot;but you provided </span><span class="si">{</span><span class="n">quorum</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="p">[</span><span class="s1">&#39;min_genes_required&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">opt</span></div>


<div class="viewcode-block" id="Config.min_genes_required"><a class="viewcode-back" href="../../developer_guide/api/config.html#macsypy.config.Config.min_genes_required">[docs]</a>    <span class="k">def</span> <span class="nf">min_genes_required</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_fqn</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param str model_fqn: the model fully qualifed name</span>
<span class="sd">        :return: the min_genes_required for the model_fqn or None if it&#39;s does not specify</span>
<span class="sd">        :rtype: int or None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="p">[</span><span class="s1">&#39;min_genes_required&#39;</span><span class="p">]:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="p">[</span><span class="s1">&#39;min_genes_required&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">model_fqn</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="Config._set_min_mandatory_genes_required"><a class="viewcode-back" href="../../developer_guide/api/config.html#macsypy.config.Config._set_min_mandatory_genes_required">[docs]</a>    <span class="k">def</span> <span class="nf">_set_min_mandatory_genes_required</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        set value for &#39;min_mandatory_genes_required&#39; option</span>

<span class="sd">        :param str value: the string parse representing the model fully qualified name</span>
<span class="sd">                          and it&#39;s associated value and so on</span>
<span class="sd">                          the model_fqn is a string, the associated value must be cast in int</span>
<span class="sd">        :raise ValueError: if value is not well formed</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">opt</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_str_2_tuple</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid syntax for &#39;min_mandatory_genes_required&#39;: </span><span class="si">{</span><span class="n">err</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">model_fqn</span><span class="p">,</span> <span class="n">quorum</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">opt</span><span class="p">[</span><span class="n">model_fqn</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">quorum</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The value for &#39;min_mandatory_genes_required&#39; option &quot;</span>
                                 <span class="sa">f</span><span class="s2">&quot;for model </span><span class="si">{</span><span class="n">model_fqn</span><span class="si">}</span><span class="s2"> must be an integer, but you provided </span><span class="si">{</span><span class="n">quorum</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="p">[</span><span class="s1">&#39;min_mandatory_genes_required&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">opt</span></div>


<div class="viewcode-block" id="Config.min_mandatory_genes_required"><a class="viewcode-back" href="../../developer_guide/api/config.html#macsypy.config.Config.min_mandatory_genes_required">[docs]</a>    <span class="k">def</span> <span class="nf">min_mandatory_genes_required</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_fqn</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param str model_fqn: the model fully qualifed name</span>
<span class="sd">        :return: the min_mandatory_genes_required for the model_fqn or None if it&#39;s does not specify</span>
<span class="sd">        :rtype: int or None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="p">[</span><span class="s1">&#39;min_mandatory_genes_required&#39;</span><span class="p">]:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="p">[</span><span class="s1">&#39;min_mandatory_genes_required&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">model_fqn</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="Config._set_models"><a class="viewcode-back" href="../../developer_guide/api/config.html#macsypy.config.Config._set_models">[docs]</a>    <span class="k">def</span> <span class="nf">_set_models</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param value: The models to search as return by the command line parsing or</span>
<span class="sd">                      the configuration files</span>

<span class="sd">                      if value come from command_line</span>
<span class="sd">                          [&#39;model1&#39;, &#39;def1&#39;, &#39;def2&#39;, &#39;def3&#39;]</span>
<span class="sd">                      if value come from config file</span>
<span class="sd">                         &#39;set_1&#39;, &#39;T9SS T3SS T4SS_typeI&#39;)]</span>
<span class="sd">                         [(model_family, [def_name1, ...]), ... ]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="c1"># it comes from a config_file</span>
            <span class="c1"># value = model_family_name model1 model2</span>
            <span class="n">model_family_name</span><span class="p">,</span> <span class="o">*</span><span class="n">models_name</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># it come from the command line</span>
            <span class="c1"># value = [&#39;model_family_name&#39;, &#39;model1&#39;, &#39;model2&#39;]</span>
            <span class="n">model_family_name</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">models_name</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="p">[</span><span class="s1">&#39;models&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">model_family_name</span><span class="p">,</span> <span class="n">models_name</span><span class="p">)</span></div>


<div class="viewcode-block" id="Config.out_dir"><a class="viewcode-back" href="../../developer_guide/api/config.html#macsypy.config.Config.out_dir">[docs]</a>    <span class="k">def</span> <span class="nf">out_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :return: the path to the directory where the results are stored</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">out_dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="p">[</span><span class="s1">&#39;out_dir&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">out_dir</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">out_dir</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">out_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="p">[</span><span class="s1">&#39;res_search_dir&#39;</span><span class="p">],</span>
                                   <span class="sa">f</span><span class="s2">&quot;macsyfinder-</span><span class="si">{</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y%m</span><span class="si">%d</span><span class="s1">_%H-%M-%S&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="p">[</span><span class="s1">&#39;out_dir&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">out_dir</span>
            <span class="k">return</span> <span class="n">out_dir</span></div>


<div class="viewcode-block" id="Config.working_dir"><a class="viewcode-back" href="../../developer_guide/api/config.html#macsypy.config.Config.working_dir">[docs]</a>    <span class="k">def</span> <span class="nf">working_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        alias to :py:meth:`config.Config.out_dir`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_dir</span><span class="p">()</span></div>


<div class="viewcode-block" id="Config._set_replicon_topology"><a class="viewcode-back" href="../../developer_guide/api/config.html#macsypy.config.Config._set_replicon_topology">[docs]</a>    <span class="k">def</span> <span class="nf">_set_replicon_topology</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        set the default replicon topology</span>

<span class="sd">        :param str value: &#39;circular&#39; or &#39;linear&#39;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">auth_values</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="s1">&#39;circular&#39;</span><span class="p">)</span>
        <span class="n">value_low</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="n">new_topo</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">topo</span> <span class="ow">in</span> <span class="n">auth_values</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">topo</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">value_low</span><span class="p">):</span>
                <span class="n">new_topo</span> <span class="o">=</span> <span class="n">topo</span>
                <span class="k">break</span>
        <span class="k">if</span> <span class="n">new_topo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="p">[</span><span class="s1">&#39;replicon_topology&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_topo</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;replicon_topology as unauthorized value : &#39;</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="Config._set_sequence_db"><a class="viewcode-back" href="../../developer_guide/api/config.html#macsypy.config.Config._set_sequence_db">[docs]</a>    <span class="k">def</span> <span class="nf">_set_sequence_db</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param str path: set the path to the sequence file (in fasta format) to analysed</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="p">[</span><span class="s1">&#39;sequence_db&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">path</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;sequence_db &#39;</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">&#39; does not exists or is not a file.&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="Config._set_topology_file"><a class="viewcode-back" href="../../developer_guide/api/config.html#macsypy.config.Config._set_topology_file">[docs]</a>    <span class="k">def</span> <span class="nf">_set_topology_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        test if the path exists and set it in config</span>

<span class="sd">        :param str path: the path to the topology file</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="p">[</span><span class="s1">&#39;topology_file&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">path</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;topology_file &#39;</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">&#39; does not exists or is not a file.&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="Config._set_models_dir"><a class="viewcode-back" href="../../developer_guide/api/config.html#macsypy.config.Config._set_models_dir">[docs]</a>    <span class="k">def</span> <span class="nf">_set_models_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param str path: the path to the models (definitions + profiles) are stored.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="p">[</span><span class="s1">&#39;models_dir&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">path</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;models_dir &#39;</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">&#39; does not exists or is not a directory.&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="Config._set_multi_loci"><a class="viewcode-back" href="../../developer_guide/api/config.html#macsypy.config.Config._set_multi_loci">[docs]</a>    <span class="k">def</span> <span class="nf">_set_multi_loci</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param str value: the models fqn list separated by comma of multi loc models</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">models_fqn</span> <span class="o">=</span> <span class="p">{</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">value</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)]</span> <span class="k">if</span> <span class="n">v</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="p">[</span><span class="s1">&#39;multi_loci&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">models_fqn</span><span class="p">)</span></div>


<div class="viewcode-block" id="Config.multi_loci"><a class="viewcode-back" href="../../developer_guide/api/config.html#macsypy.config.Config.multi_loci">[docs]</a>    <span class="k">def</span> <span class="nf">multi_loci</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_fqn</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param str model_fqn: the model fully qualified name</span>
<span class="sd">        :return: True if the model is multi loci, False otherwise</span>
<span class="sd">        :rtype: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">model_fqn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="p">[</span><span class="s1">&#39;multi_loci&#39;</span><span class="p">]</span></div>


<div class="viewcode-block" id="Config.hmmer_dir"><a class="viewcode-back" href="../../developer_guide/api/config.html#macsypy.config.Config.hmmer_dir">[docs]</a>    <span class="k">def</span> <span class="nf">hmmer_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        :return: The name of the directory containing the hmmsearch results (output, error, parsing)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s1">&#39;hmmer_results&#39;</span></div>


<div class="viewcode-block" id="Config.hit_weights"><a class="viewcode-back" href="../../developer_guide/api/config.html#macsypy.config.Config.hit_weights">[docs]</a>    <span class="k">def</span> <span class="nf">hit_weights</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        :return: the options used in scoring systems (mandatory_weight, accessory_weight, itself_weight,</span>
<span class="sd">                 exchangeable_weight, loner_multi_system_weight)</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;mandatory&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="p">[</span><span class="s1">&#39;mandatory_weight&#39;</span><span class="p">],</span>
                <span class="s1">&#39;accessory&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="p">[</span><span class="s1">&#39;accessory_weight&#39;</span><span class="p">],</span>
                <span class="s1">&#39;neutral&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="p">[</span><span class="s1">&#39;neutral_weight&#39;</span><span class="p">],</span>
                <span class="s1">&#39;itself&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="p">[</span><span class="s1">&#39;itself_weight&#39;</span><span class="p">],</span>
                <span class="s1">&#39;exchangeable&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="p">[</span><span class="s1">&#39;exchangeable_weight&#39;</span><span class="p">],</span>
                <span class="s1">&#39;loner_multi_system&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="p">[</span><span class="s1">&#39;loner_multi_system_weight&#39;</span><span class="p">]</span>
                <span class="p">}</span></div>

<div class="viewcode-block" id="Config.log_level"><a class="viewcode-back" href="../../developer_guide/api/config.html#macsypy.config.Config.log_level">[docs]</a>    <span class="k">def</span> <span class="nf">log_level</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :return: the verbosity output level</span>
<span class="sd">        :rtype: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">level</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_defaults</span><span class="o">.</span><span class="n">log_level</span> <span class="o">-</span> <span class="p">(</span><span class="mi">10</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbosity</span><span class="p">())</span> <span class="o">+</span> <span class="p">(</span><span class="mi">10</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">quiet</span><span class="p">())</span>
        <span class="n">level</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">level</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">level</span></div></div>


<span class="k">class</span> <span class="nc">NoneConfig</span><span class="p">:</span>

    <span class="k">def</span> <span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">property</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">property</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;multi_loci&#39;</span><span class="p">,</span> <span class="s1">&#39;min_mandatory_genes_required&#39;</span><span class="p">,</span> <span class="s1">&#39;max_nb_genes&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;inter_gene_max_space&#39;</span><span class="p">,</span> <span class="s1">&#39;min_genes_required&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="k">lambda</span><span class="p">:</span> <span class="kc">None</span>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014-2021, &#39;Institut Pasteur (Paris), CNRS&#39;

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
    

  

  <script type="text/javascript" src="../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

<a href="https://github.com/gem-pasteur/macsyfinder">
    <img style="position: absolute; top: 0; right: 0; border: 0;"
         src="https://camo.githubusercontent.com/38ef81f8aca64bb9a64448d0d70f1308ef5341ab/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f6461726b626c75655f3132313632312e706e67"
         alt="Fork me on GitHub"
         data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png">
</a>



</body>
</html>