(window.sntryWpJsonp=window.sntryWpJsonp||[]).push([[39],{1918:function(t,e,n){"use strict";n.d(e,"a",(function(){return O}));var r=n(9),a=n.n(r),o=n(10),c=n.n(o),i=n(11),u=n.n(i),l=n(12),s=n.n(l),f=n(6),d=n.n(f),b=(n(1),n(264)),p=n.n(b),h=n(704),y=n(0);function m(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=d()(t);if(e){var a=d()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return s()(this,n)}}var O=function(t){u()(n,t);var e=m(n);function n(){return a()(this,n),e.apply(this,arguments)}return c()(n,[{key:"getTitle",value:function(){return""}},{key:"render",value:function(){var t=this.getTitle();return Object(y.f)(p.a,{title:"".concat(t?"".concat(t," - "):"","Sentry")},this.renderComponent())}}]),n}(h.a);O.displayName="AsyncView"},1920:function(t,e,n){"use strict";var r=n(14),a=n.n(r),o=n(9),c=n.n(o),i=n(10),u=n.n(i),l=n(11),s=n.n(l),f=n(12),d=n.n(f),b=n(6),p=n.n(b),h=n(3),y=n(1),m=n.n(y),O=n(220),v=n(7),j=n(0);function g(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p()(t);if(e){var a=p()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return d()(this,n)}}var S=function(t){s()(n,t);var e=g(n);function n(){return c()(this,n),e.apply(this,arguments)}return u()(n,[{key:"render",value:function(){var t=this.props,e=t.icon,n=t.title,r=t.subtitle,o=t.action,c=t.tabs,i=t.noTitleStyles,u=t.body,l=a()(t,["icon","title","subtitle","action","tabs","noTitleStyles","body"]),s=!r;return Object(j.f)("div",l,Object(j.f)(k,{isNarrow:s},Object(j.f)(w,null,e&&Object(j.f)(C,null,e),n&&Object(j.f)(x,{tabs:c,styled:i},Object(j.f)(O.a,null,n),r&&Object(j.f)(E,null,r))),o&&Object(j.f)(R,{isNarrow:s},o)),u&&Object(j.f)(P,null,u),c&&Object(j.f)(D,null,c))}}]),n}(m.a.Component);S.displayName="UnstyledSettingsPageHeader",S.defaultProps={noTitleStyles:!1};var k=Object(h.a)("div",{target:"e1uay4fd0",label:"TitleAndActions"})("display:flex;align-items:",(function(t){return t.isNarrow?"center":"flex-start"}),";"),w=Object(h.a)("div",{target:"e1uay4fd1",label:"TitleWrapper"})({name:"1rr4qq7",styles:"flex:1;"}),x=Object(h.a)("div",{target:"e1uay4fd2",label:"Title"})((function(t){return!t.styled&&"font-size: 20px; font-weight: 600;"}),";margin:",Object(v.a)(4)," ",Object(v.a)(2)," ",Object(v.a)(3)," 0;"),E=Object(h.a)("div",{target:"e1uay4fd3",label:"Subtitle"})("color:",(function(t){return t.theme.gray400}),";font-weight:400;font-size:",(function(t){return t.theme.fontSizeLarge}),";padding:",Object(v.a)(1.5)," 0 0;"),C=Object(h.a)("div",{target:"e1uay4fd4",label:"Icon"})("margin-right:",Object(v.a)(1),";"),R=Object(h.a)("div",{target:"e1uay4fd5",label:"Action"})("margin-top:",(function(t){return t.isNarrow?"0":Object(v.a)(4)}),";"),T=Object(h.a)(S,{target:"e1uay4fd6",label:"SettingsPageHeader"})("font-size:14px;margin-top:-",Object(v.a)(4),";"),P=Object(h.a)("div",{target:"e1uay4fd7",label:"BodyWrapper"})("flex:1;margin:0 0 ",Object(v.a)(3),";"),D=Object(h.a)("div",{target:"e1uay4fd8",label:"TabsWrapper"})({name:"8k0ai7",styles:"flex:1;margin:0;"});e.a=T},2115:function(t,e,n){"use strict";var r=n(3),a=Object(r.a)("div",{target:"e1pnf9a40",label:"ConfirmHeader"})({name:"1pihav0",styles:"font-size:1.2em;margin-bottom:10px;"});e.a=a},2134:function(t,e,n){"use strict";var r=n(5),a=n.n(r),o=n(1),c=n.n(o),i=n(138),u=n(2),l=n(2115),s=n(706),f=n(0),d=Object(f.f)(c.a.Fragment,null,Object(f.f)(l.a,null,Object(u.b)("Do you want to remove this method?")),Object(f.f)(s.a,null,Object(u.b)("Removing the last authentication method will disable two-factor authentication completely."))),b=function(t){return Object(f.f)(i.a,a()({},t,{message:d}))};b.displayName="RemoveConfirm",e.a=b},2262:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(255),a=n.n(r),o=n(65);function c(){var t=a.a.get("pending-invite");return t?o.parse(t):null}},2919:function(t,e,n){"use strict";n.r(e);var r=n(29),a=n.n(r),o=n(21),c=n.n(o),i=n(30),u=n.n(i),l=n(9),s=n.n(l),f=n(10),d=n.n(f),b=n(180),p=n.n(b),h=n(11),y=n.n(h),m=n(12),O=n.n(m),v=n(6),j=n.n(v),g=n(8),S=n.n(g),k=n(24),w=n.n(k),x=n(1),E=n.n(x),C=n(22),R=n(34),T=n(64),P=n(447),D=n(26),N=n(726),A=n(96),q=n(3),I=n(0),M=function(t){var e=t.code;return Object(I.f)(F,null,Object(I.f)("tbody",null,e.map((function(t,e){return Object(I.f)("tr",{key:e},t.map((function(t,e){return t?Object(I.f)(B,{key:e}):Object(I.f)(W,{key:e})})))}))))};M.displayName="Qrcode";var z=Object(q.a)("td",{target:"e8bpnt20",label:"Cell"})({name:"1c97kwh",styles:"height:6px;width:6px;padding:0;"}),B=Object(q.a)(z,{target:"e8bpnt21",label:"BlackCell"})({name:"1qzfsby",styles:"background-color:black;"}),W=Object(q.a)(z,{target:"e8bpnt22",label:"WhiteCell"})({name:"cxmp86",styles:"background-color:white;"}),F=Object(q.a)("table",{target:"e8bpnt23",label:"Table"})({name:"1uk1gs8",styles:"margin:0;"}),J=M,U=n(1134),V=n(2),H=n(2262),L=n(1918),Q=n(2134),G=n(707),K=n(322),X=n(708),Y=n(266),Z=n(712),$=n(1920),_=n(706);function tt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=j()(t);if(e){var a=j()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return O()(this,n)}}function et(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function nt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?et(Object(n),!0).forEach((function(e){S()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):et(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var rt={name:"1v994a0",styles:"margin-right:6px;"},at={name:"1ttqh2b-AccountSecurityEnroll",styles:"margin-left:6px;;label:AccountSecurityEnroll;"},ot=function(t){y()(r,t);var e,n=tt(r);function r(){var t;s()(this,r);for(var e=arguments.length,a=new Array(e),o=0;o<e;o++)a[o]=arguments[o];return(t=n.call.apply(n,[this].concat(a))).formModel=new Y.b,t.pendingInvitation=null,t.handleSmsReset=function(){return t.setState({hasSentCode:!1},t.remountComponent)},t.handleSmsSubmit=function(){var e=u()(c.a.mark((function e(n){var r,a,o,i,u,l;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.state,a=r.authenticator,o=r.hasSentCode,i=n.phone,u=n.otp,i&&a){e.next=4;break}return e.abrupt("return");case 4:return l={phone:i,otp:o?u:void 0,secret:a.secret},t.setState({sendingCode:!o}),o?Object(R.b)(Object(V.b)("Verifying OTP...")):Object(R.b)(Object(V.b)("Sending code to %s...",l.phone)),e.prev=7,e.next=10,t.api.requestPromise(t.enrollEndpoint,{data:l});case 10:e.next=19;break;case 12:return e.prev=12,e.t0=e.catch(7),t.formModel.resetForm(),Object(R.a)(t.state.hasSentCode?Object(V.b)("Incorrect OTP"):Object(V.b)("Error sending SMS")),t.setState({hasSentCode:!1,sendingCode:!1}),t.remountComponent(),e.abrupt("return");case 19:o?t.handleEnrollSuccess():(t.setState({hasSentCode:!0,sendingCode:!1}),Object(R.c)(Object(V.b)("Sent code to %s",l.phone)));case 20:case"end":return e.stop()}}),e,null,[[7,12]])})));return function(t){return e.apply(this,arguments)}}(),t.handleU2fTap=function(){var e=u()(c.a.mark((function e(n){var r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=nt(nt({},n),t.formModel.fields.toJS()),t.setState({loading:!0}),e.prev=2,e.next=5,t.api.requestPromise(t.enrollEndpoint,{data:r});case 5:e.next=11;break;case 7:return e.prev=7,e.t0=e.catch(2),t.handleEnrollError(),e.abrupt("return");case 11:t.handleEnrollSuccess();case 12:case"end":return e.stop()}}),e,null,[[2,7]])})));return function(t){return e.apply(this,arguments)}}(),t.handleTotpSubmit=function(){var e=u()(c.a.mark((function e(n){var r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.state.authenticator){e.next=2;break}return e.abrupt("return");case 2:return r=nt(nt({},null!=n?n:{}),{},{secret:t.state.authenticator.secret}),t.setState({loading:!0}),e.prev=4,e.next=7,t.api.requestPromise(t.enrollEndpoint,{method:"POST",data:r});case 7:e.next=13;break;case 9:return e.prev=9,e.t0=e.catch(4),t.handleEnrollError(),e.abrupt("return");case 13:t.handleEnrollSuccess();case 14:case"end":return e.stop()}}),e,null,[[4,9]])})));return function(t){return e.apply(this,arguments)}}(),t.handleSubmit=function(e){var n,r=null===(n=t.state.authenticator)||void 0===n?void 0:n.id;"totp"!==r?"sms"!==r||t.handleSmsSubmit(e):t.handleTotpSubmit(e)},t.handleRemove=u()(c.a.mark((function e(){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((n=t.state.authenticator)&&n.authId){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,e.next=6,t.api.requestPromise(t.authenticatorEndpoint,{method:"DELETE"});case 6:e.next=12;break;case 8:return e.prev=8,e.t0=e.catch(3),Object(R.a)(Object(V.b)("Error removing authenticator")),e.abrupt("return");case 12:t.props.router.push("/settings/account/security/"),Object(R.c)(Object(V.b)("Authenticator has been removed"));case 14:case"end":return e.stop()}}),e,null,[[3,8]])}))),t}return d()(r,[{key:"getTitle",value:function(){return Object(V.b)("Security")}},{key:"getDefaultState",value:function(){return nt(nt({},p()(j()(r.prototype),"getDefaultState",this).call(this)),{},{hasSentCode:!1})}},{key:"getEndpoints",value:function(){var t=this;return[["authenticator",this.enrollEndpoint,{},{allowError:function(e){var n=e&&400===e.status&&e.responseJSON&&"Already enrolled"===e.responseJSON.details;return n&&(t.props.router.push("/settings/account/security/"),Object(R.a)(Object(V.b)("Already enrolled"))),n}}]]}},{key:"componentDidMount",value:function(){this.pendingInvitation=Object(H.a)()}},{key:"handleEnrollSuccess",value:(e=u()(c.a.mark((function t(){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.pendingInvitation){t.next=3;break}return t.next=3,Object(P.b)(this.pendingInvitation.memberId.toString(),{addOrg:!0,fetchOrgDetails:!0});case 3:this.props.router.push("/settings/account/security/"),Object(T.k)({authenticatorName:this.authenticatorName});case 5:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"handleEnrollError",value:function(){this.setState({loading:!1}),Object(R.a)(Object(V.b)("Error adding %s authenticator",this.authenticatorName))}},{key:"renderBody",value:function(){var t,e=this.state,n=e.authenticator,r=e.hasSentCode,o=e.sendingCode;if(!n)return null;var c=function(t){var e=t.authenticator,n=t.hasSentCode,r=t.sendingCode,a=t.onSmsReset,o=t.onU2fTap,c=e.form;return c?"totp"===e.id?[function(){return Object(I.f)(A.f,{key:"qrcode",justifyContent:"center",p:2},Object(I.f)(J,{code:e.qrcode}))},function(){var t;return Object(I.f)(G.a,{key:"secret",label:Object(V.b)("Authenticator secret")},Object(I.f)(Z.a,null,null!==(t=e.secret)&&void 0!==t?t:""))}].concat(w()(c),[function(){return Object(I.f)(A.f,{key:"confirm",justifyContent:"flex-end",p:2},Object(I.f)(D.b,{priority:"primary",type:"submit"},Object(V.b)("Confirm")))}]):"sms"===e.id?[nt(nt({},c[0]),{},{disabled:r||n})].concat(w()(n?[nt(nt({},c[1]),{},{required:!0})]:[]),[function(){return Object(I.f)(A.f,{key:"sms-footer",justifyContent:"flex-end",p:2,pr:"36px"},n&&Object(I.f)(D.b,{css:rt,onClick:a},Object(V.b)("Start Over")),Object(I.f)(D.b,{priority:"primary",type:"submit"},n?Object(V.b)("Confirm"):Object(V.b)("Send Code")))}]):"u2f"===e.id?[c.find((function(t){return"deviceName"===t.name})),function(){return Object(I.f)(U.default,{key:"u2f-enroll",style:{marginBottom:0},challengeData:e.challenge,displayMode:"enroll",onTap:o})}]:null:null}({authenticator:n,hasSentCode:r,sendingCode:o,onSmsReset:this.handleSmsReset,onU2fTap:this.handleU2fTap}),i=c?c.filter((function(t){return"function"!=typeof t&&void 0!==t.defaultValue})).map((function(t){return[t.name,"function"!=typeof t?t.defaultValue:""]})).reduce((function(t,e){var n=a()(e,2),r=n[0],o=n[1];return t[r]=o,t}),{}):{};return Object(I.f)(E.a.Fragment,null,Object(I.f)($.a,{title:Object(I.f)(E.a.Fragment,null,Object(I.f)("span",null,n.name),Object(I.f)(N.a,{css:at,enabled:n.isEnrolled})),action:n.isEnrolled&&n.removeButton&&Object(I.f)(Q.a,{onConfirm:this.handleRemove},Object(I.f)(D.b,{priority:"danger"},n.removeButton))}),Object(I.f)(_.a,null,n.description),!(null===(t=n.form)||void 0===t||!t.length)&&Object(I.f)(K.a,{model:this.formModel,apiMethod:"POST",apiEndpoint:this.authenticatorEndpoint,onSubmit:this.handleSubmit,initialData:nt(nt({},i),n),hideFooter:!0},Object(I.f)(X.a,{forms:[{title:"Configuration",fields:null!=c?c:[]}]})))}},{key:"authenticatorEndpoint",get:function(){return"/users/me/authenticators/".concat(this.props.params.authId,"/")}},{key:"enrollEndpoint",get:function(){return"".concat(this.authenticatorEndpoint,"enroll/")}},{key:"authenticatorName",get:function(){var t,e;return null!==(t=null===(e=this.state.authenticator)||void 0===e?void 0:e.name)&&void 0!==t?t:"Authenticator"}}]),r}(L.a);e.default=Object(C.withRouter)(ot)}}]);
//# sourceMappingURL=AccountSecurityEnroll.js.map