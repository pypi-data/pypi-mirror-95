(window.sntryWpJsonp=window.sntryWpJsonp||[]).push([[26],{1920:function(e,t,n){"use strict";var r=n(14),a=n.n(r),i=n(9),o=n.n(i),c=n(10),l=n.n(c),s=n(11),u=n.n(s),d=n(12),f=n.n(d),p=n(6),b=n.n(p),h=n(3),g=n(1),v=n.n(g),y=n(220),O=n(7),j=n(0);function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=b()(e);if(t){var a=b()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}var S=function(e){u()(n,e);var t=m(n);function n(){return o()(this,n),t.apply(this,arguments)}return l()(n,[{key:"render",value:function(){var e=this.props,t=e.icon,n=e.title,r=e.subtitle,i=e.action,o=e.tabs,c=e.noTitleStyles,l=e.body,s=a()(e,["icon","title","subtitle","action","tabs","noTitleStyles","body"]),u=!r;return Object(j.f)("div",s,Object(j.f)(R,{isNarrow:u},Object(j.f)(E,null,t&&Object(j.f)(A,null,t),n&&Object(j.f)(I,{tabs:o,styled:c},Object(j.f)(y.a,null,n),r&&Object(j.f)(w,null,r))),i&&Object(j.f)(x,{isNarrow:u},i)),l&&Object(j.f)(C,null,l),o&&Object(j.f)(D,null,o))}}]),n}(v.a.Component);S.displayName="UnstyledSettingsPageHeader",S.defaultProps={noTitleStyles:!1};var R=Object(h.a)("div",{target:"e1uay4fd0",label:"TitleAndActions"})("display:flex;align-items:",(function(e){return e.isNarrow?"center":"flex-start"}),";"),E=Object(h.a)("div",{target:"e1uay4fd1",label:"TitleWrapper"})({name:"1rr4qq7",styles:"flex:1;"}),I=Object(h.a)("div",{target:"e1uay4fd2",label:"Title"})((function(e){return!e.styled&&"font-size: 20px; font-weight: 600;"}),";margin:",Object(O.a)(4)," ",Object(O.a)(2)," ",Object(O.a)(3)," 0;"),w=Object(h.a)("div",{target:"e1uay4fd3",label:"Subtitle"})("color:",(function(e){return e.theme.gray400}),";font-weight:400;font-size:",(function(e){return e.theme.fontSizeLarge}),";padding:",Object(O.a)(1.5)," 0 0;"),A=Object(h.a)("div",{target:"e1uay4fd4",label:"Icon"})("margin-right:",Object(O.a)(1),";"),x=Object(h.a)("div",{target:"e1uay4fd5",label:"Action"})("margin-top:",(function(e){return e.isNarrow?"0":Object(O.a)(4)}),";"),k=Object(h.a)(S,{target:"e1uay4fd6",label:"SettingsPageHeader"})("font-size:14px;margin-top:-",Object(O.a)(4),";"),C=Object(h.a)("div",{target:"e1uay4fd7",label:"BodyWrapper"})("flex:1;margin:0 0 ",Object(O.a)(3),";"),D=Object(h.a)("div",{target:"e1uay4fd8",label:"TabsWrapper"})({name:"8k0ai7",styles:"flex:1;margin:0;"});t.a=k},1923:function(e,t,n){"use strict";n(1);var r=n(264),a=n.n(r),i=n(0),o=function(e){var t="".concat(e.title," - ").concat(e.objSlug," - Sentry");return Object(i.f)(a.a,{title:t},e.children)};o.displayName="SentryDocumentTitle",t.a=o},2123:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return c}));var r,a=n(2),i=n(18);function o(e,t){return null===e&&Object(i.d)(t)?Object(a.c)("Inherit organization settings ([organizationValue])",{organizationValue:o(t)}):-1===e?Object(a.b)("Unlimited"):0===e?Object(a.b)("Disabled"):Object(a.c)("[value] per issue",{value:e})}function c(e){var t=[0,1,5,10,20,-1];return e===r.Project&&t.unshift(null),t}!function(e){e[e.Organization=0]="Organization",e[e.Project=1]="Project"}(r||(r={}))},2424:function(e,t,n){"use strict";var r,a,i,o,c=n(21),l=n.n(c),s=n(30),u=n.n(s),d=n(5),f=n.n(d),p=n(9),b=n.n(p),h=n(10),g=n.n(h),v=n(11),y=n.n(v),O=n(12),j=n.n(O),m=n(6),S=n.n(m),R=n(3),E=n(1),I=n.n(E),w=n(34),A=n(64),x=n(52),k=n(26),C=n(43),D=n(96),P=n(2),N=n(7),T=n(8),U=n.n(T),V=n(24),L=n.n(V),F=n(14),z=n.n(F),M=n(60),H=n.n(M),q=n(113),W=n.n(q);function B(e){return e.type===r.PATTERN&&e.method===a.REPLACE?{type:e.type,pattern:e.pattern,redaction:{method:e.method,text:null==e?void 0:e.placeholder}}:e.type===r.PATTERN?{type:e.type,pattern:e.pattern,redaction:{method:e.method}}:e.method===a.REPLACE?{type:e.type,redaction:{method:e.method,text:null==e?void 0:e.placeholder}}:{type:e.type,redaction:{method:e.method}}}!function(e){e.PATTERN="pattern",e.CREDITCARD="creditcard",e.PASSWORD="password",e.IP="ip",e.IMEI="imei",e.EMAIL="email",e.UUID="uuid",e.PEMKEY="pemkey",e.URLAUTH="url_auth",e.USSSN="us_ssn",e.USER_PATH="userpath",e.MAC="mac",e.ANYTHING="anything"}(r||(r={})),function(e){e.MASK="mask",e.REMOVE="remove",e.HASH="hash",e.REPLACE="replace"}(a||(a={})),function(e){e.UNDEFINED="undefined",e.LOADING="loading",e.INVALID="invalid",e.NOT_FOUND="not_found",e.LOADED="loaded",e.ERROR="error"}(i||(i={})),function(e){e.VALUE="value",e.UNARY="unary",e.BINARY="binary",e.STRING="string"}(o||(o={}));var _=function(e,t,n){for(var r={},a={},i=0;i<n.length;i++){var o=n[i],c=String(i);a[c]=B(o),r[o.source]||(r[o.source]=[]),r[o.source].includes(c)||r[o.source].push(c)}var l={rules:a,applications:r};return e.requestPromise(t,{method:"PUT",data:{relayPiiConfig:JSON.stringify(l)}})};function Y(e){switch(e){case r.ANYTHING:return Object(P.b)("Anything");case r.IMEI:return Object(P.b)("IMEI numbers");case r.MAC:return Object(P.b)("MAC addresses");case r.EMAIL:return Object(P.b)("Email addresses");case r.PEMKEY:return Object(P.b)("PEM keys");case r.URLAUTH:return Object(P.b)("Auth in URLs");case r.USSSN:return Object(P.b)("US social security numbers");case r.USER_PATH:return Object(P.b)("Usernames in filepaths");case r.UUID:return Object(P.b)("UUIDs");case r.CREDITCARD:return Object(P.b)("Credit card numbers");case r.PASSWORD:return Object(P.b)("Password fields");case r.IP:return Object(P.b)("IP addresses");case r.PATTERN:return Object(P.b)("Regex matches");default:return""}}function G(e){switch(e){case a.MASK:return{label:Object(P.b)("Mask"),description:Object(P.b)("Replace with ****")};case a.HASH:return{label:Object(P.b)("Hash"),description:Object(P.b)("Replace with DEADBEEF")};case a.REMOVE:return{label:Object(P.b)("Remove"),description:Object(P.b)("Replace with null")};case a.REPLACE:return{label:Object(P.b)("Replace"),description:Object(P.b)("Replace with Placeholder")};default:return{label:""}}}var X=[{type:o.BINARY,value:"&&"},{type:o.BINARY,value:"||"}],$=[{type:o.UNARY,value:"!"}],K=[{type:o.VALUE,value:"**",description:Object(P.b)("everywhere")},{type:o.VALUE,value:"password",description:Object(P.b)('attributes named "password"')},{type:o.VALUE,value:"$error.value",description:Object(P.b)("the exception value")},{type:o.VALUE,value:"$message",description:Object(P.b)("the log message")},{type:o.VALUE,value:"extra.MyValue",description:Object(P.b)('the key "MyValue" in "Additional Data"')},{type:o.VALUE,value:"extra.**",description:Object(P.b)('everything in "Additional Data"')},{type:o.VALUE,value:"$http.headers.x-custom-token",description:Object(P.b)("the X-Custom-Token HTTP header")},{type:o.VALUE,value:"$user.ip_address",description:Object(P.b)("the user IP address")},{type:o.VALUE,value:"$frame.vars.foo",description:Object(P.b)('the local variable "foo"')},{type:o.VALUE,value:"contexts.device.timezone",description:Object(P.b)("the timezone in the device context")},{type:o.VALUE,value:"tags.server_name",description:Object(P.b)('the tag "server_name"')},{type:o.VALUE,value:"$attachments.**",description:Object(P.b)("all attachments")},{type:o.VALUE,value:"$attachments.'logfile.txt'",description:Object(P.b)('all attachments named "logfile.txt"')},{type:o.VALUE,value:"$minidump",description:Object(P.b)("the entire minidump of a native crash report")},{type:o.VALUE,value:"$minidump.heap_memory",description:Object(P.b)("the heap memory region in a native crash report")},{type:o.VALUE,value:"code_file",description:Object(P.b)("the pathname of a code module in a native crash report")},{type:o.VALUE,value:"debug_file",description:Object(P.b)("the pathname of a debug module in a native crash report")}],J=n(387),Z=n.n(J),Q=n(15),ee=n(222),te=n(707),ne=n(49),re=n(136);function ae(e){try{re.a.setItem("advanced-data-scrubbing",JSON.stringify(e))}catch(t){ne.c(t),ne.m((function(n){n.setExtra("storage",e),ne.c(t)}))}}function ie(){var e=function(){var e=re.a.getItem("advanced-data-scrubbing");if(e)try{return JSON.parse(e)}catch(t){return void ne.m((function(n){n.setExtra("storage",e),ne.c(t)}))}}();if(!e){var t={eventId:"",sourceSuggestions:K};return ae(t),t}return e}function oe(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:K;switch(e.status){case i.LOADING:break;case i.LOADED:ae({eventId:e.value,sourceSuggestions:t});break;default:ae({eventId:"",sourceSuggestions:t})}}var ce=n(31),le=n(540),se=n(0),ue=function(e){var t=e.status,n=e.onClickIconClose;switch(t){case i.ERROR:case i.INVALID:case i.NOT_FOUND:return Object(se.f)(de,{onClick:n},Object(se.f)(ce.a,{title:Object(P.b)("Clear event ID")},Object(se.f)(fe,{size:"xs"})));case i.LOADING:return Object(se.f)(le.a,{isSaving:!0});case i.LOADED:return Object(se.f)(Q.i,{color:"green300"});default:return null}},de=Object(R.a)("div",{target:"e1hyvjeb0",label:"CloseIcon"})({name:"15o8flj",styles:":first-child{line-height:0;}"}),fe=Object(R.a)(Q.n,{target:"e1hyvjeb1",label:"StyledIconClose"})("color:",(function(e){return e.theme.gray200}),";:hover{color:",(function(e){return e.theme.gray300}),";}cursor:pointer;");function pe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function be(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pe(Object(n),!0).forEach((function(t){U()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function he(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}var ge=function(e){y()(n,e);var t=he(n);function n(){var e;b()(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).state=be({},e.props.eventId),e.handleChange=function(t){var n=t.target.value.replace(/-/g,"").trim();n!==e.state.value&&e.setState({value:n,status:i.UNDEFINED})},e.handleBlur=function(t){t.preventDefault(),e.isEventIdValid()&&e.props.onUpdateEventId(e.state.value)},e.handleKeyDown=function(t){13===t.keyCode&&e.isEventIdValid()&&e.props.onUpdateEventId(e.state.value)},e.handleClickIconClose=function(){e.setState({value:"",status:i.UNDEFINED})},e}return g()(n,[{key:"componentDidUpdate",value:function(e){H()(e.eventId,this.props.eventId)||this.loadState()}},{key:"loadState",value:function(){this.setState(be({},this.props.eventId))}},{key:"getErrorMessage",value:function(){switch(this.state.status){case i.INVALID:return Object(P.b)("This event ID is invalid.");case i.ERROR:return Object(P.b)("An error occurred while fetching the suggestions based on this event ID.");case i.NOT_FOUND:return Object(P.b)("The chosen event ID was not found in projects you have access to.");default:return}}},{key:"isEventIdValid",value:function(){var e=this.state,t=e.value,n=e.status;return!t||32===t.length||(n!==i.INVALID&&(oe({value:t,status:n}),this.setState({status:i.INVALID})),!1)}},{key:"render",value:function(){var e=this.props.disabled,t=this.state,n=t.value,r=t.status;return Object(se.f)(te.a,{"data-test-id":"event-id-field",label:Object(P.b)("Event ID (Optional)"),help:Object(P.b)("Providing an event ID will automatically provide you a list of suggested sources"),inline:!1,error:this.getErrorMessage(),flexibleControlStateSize:!0,stacked:!0,showHelpInTooltip:!0},Object(se.f)(je,null,Object(se.f)(ye,{type:"text",name:"eventId",disabled:e,value:n,placeholder:Object(P.b)("XXXXXXXXXXXXXX"),onChange:this.handleChange,onKeyDown:this.handleKeyDown,onBlur:this.handleBlur}),Object(se.f)(Oe,null,Object(se.f)(ue,{onClickIconClose:this.handleClickIconClose,status:r}))))}}]),n}(I.a.Component);ge.displayName="EventIdField";var ve=ge,ye=Object(R.a)(ee.a,{target:"e1n20frx0",label:"StyledInput"})("flex:1;font-weight:400;input{padding-right:",Object(N.a)(1.5),";}margin-bottom:0;"),Oe=Object(R.a)("div",{target:"e1n20frx1",label:"Status"})("height:40px;position:absolute;right:",Object(N.a)(1.5),";top:0;display:flex;align-items:center;"),je=Object(R.a)("div",{target:"e1n20frx2",label:"FieldWrapper"})({name:"7boy05",styles:"position:relative;display:flex;align-items:center;"}),me=n(63),Se=n(117);function Re(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Re(Object(n),!0).forEach((function(t){U()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Re(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ie(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}var we=function(e){y()(n,e);var t=Ie(n);function n(){var e;b()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).selectRef=I.a.createRef(),e}return g()(n,[{key:"componentDidMount",value:function(){var e,t;this.selectRef.current&&null!==(e=this.selectRef.current)&&void 0!==e&&null!==(t=e.select)&&void 0!==t&&t.inputRef&&(this.selectRef.current.select.inputRef.autocomplete="off")}},{key:"render",value:function(){return Object(se.f)(Se.a,f()({},this.props,{isSearchable:!1,styles:{control:function(e){return Ee(Ee({},e),{},{minHeight:"41px",height:"41px"})}},ref:this.selectRef,components:{Option:function(e){var t=e.data,n=t.label,r=t.description,a=z()(t,["label","description"]),i=e.isSelected,o=z()(e,["data","isSelected"]);return Object(se.f)(me.z.Option,f()({isSelected:i,data:a},o),Object(se.f)(ke,null,Object(se.f)("div",{"data-test-id":"label"},n),r&&Object(se.f)(xe,null,"(".concat(r,")"))))}},openOnFocus:!0}))}}]),n}(I.a.Component);we.displayName="SelectField";var Ae=we,xe=Object(R.a)("div",{target:"ehgeese0",label:"Description"})("color:",(function(e){return e.theme.gray300}),";"),ke=Object(R.a)("div",{target:"ehgeese1",label:"Wrapper"})("display:grid;grid-template-columns:1fr auto;grid-gap:",Object(N.a)(1),";"),Ce=n(295),De=n(18),Pe=n(68),Ne=n(225),Te=function(e){var t=e.examples,n=e.sourceName;return Object(se.f)(Fe,null,Object(se.f)(Ve,{position:"right",header:Object(P.b)("Examples for %s in current event",Object(se.f)("code",null,n)),body:t.map((function(e){return Object(se.f)("pre",{key:e},e)}))},Object(se.f)(Le,null,Object(P.b)("See Example")," ",Object(se.f)(Q.ib,{size:"xs"}))))};Te.displayName="SourceSuggestionExamples";var Ue=Te,Ve=Object(R.a)(Ne.d,{target:"ed0uyyf0",label:"ExampleCard"})({name:"75ukw4",styles:"width:400px;pre:last-child{margin:0;}"}),Le=Object(R.a)("span",{target:"ed0uyyf1",label:"Content"})("display:inline-grid;grid-template-columns:repeat(2,max-content);align-items:center;grid-gap:",Object(N.a)(.5),";color:",(function(e){return e.theme.gray400}),";font-size:",(function(e){return e.theme.fontSizeSmall}),";text-decoration:underline;text-decoration-style:dotted;"),Fe=Object(R.a)("div",{target:"ed0uyyf2",label:"Wrapper"})({name:"cs19if",styles:"grid-column:3/3;"});function ze(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}var Me=Object(P.b)("Where to look. In the simplest case this can be an attribute name."),He=function(e){y()(n,e);var t=ze(n);function n(){var e;b()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).state={suggestions:[],fieldValues:[],activeSuggestion:0,showSuggestions:!1,hideCaret:!1,help:Me},e.selectorField=I.a.createRef(),e.suggestionList=I.a.createRef(),e.handleChange=function(t){e.loadFieldValues(t),e.props.onChange(t)},e.handleClickOutside=function(){e.setState({showSuggestions:!1,hideCaret:!1})},e.handleClickSuggestionItem=function(t){return function(){var n=e.getNewFieldValues(t);e.setState({fieldValues:n,activeSuggestion:0,showSuggestions:!1,hideCaret:!1},e.changeParentValue)}},e.handleKeyDown=function(t,n){n.persist();var r=n.keyCode,a=e.state,i=a.activeSuggestion,o=a.suggestions;if(8!==r&&32!==r)if(13!==r)if(38!==r)if(40!==r);else{if(i===o.length-1)return;e.setState({activeSuggestion:i+1},(function(){e.scrollToSuggestion()}))}else{if(0===i)return;e.setState({activeSuggestion:i-1},(function(){e.scrollToSuggestion()}))}else e.handleClickSuggestionItem(o[i])();else e.toggleSuggestions(!0)},e.handleFocus=function(){e.toggleSuggestions(!0)},e}return g()(n,[{key:"componentDidMount",value:function(){this.loadFieldValues(this.props.value),this.toggleSuggestions(!1)}},{key:"componentDidUpdate",value:function(e){e.suggestions!==this.props.suggestions&&(this.loadFieldValues(this.props.value),this.toggleSuggestions(!1)),e.isRegExMatchesSelected===this.props.isRegExMatchesSelected&&e.value===this.props.value||this.checkPossiblyRegExMatchExpression(this.props.value)}},{key:"getAllSuggestions",value:function(){return[].concat(L()(this.getValueSuggestions()),L()($),L()(X))}},{key:"getValueSuggestions",value:function(){return this.props.suggestions||[]}},{key:"getFilteredSuggestions",value:function(e,t){var n=[];switch(t){case o.BINARY:n=X;break;case o.VALUE:n=this.getValueSuggestions();break;case o.UNARY:n=$;break;default:n=[].concat(L()(this.getValueSuggestions()),L()($))}return n.filter((function(t){return t.value.toLowerCase().indexOf(e.toLowerCase())>-1}))}},{key:"getNewSuggestions",value:function(e){var t=e[e.length-1],n=e[e.length-2];return Array.isArray(t)?this.getNewSuggestions(t):Array.isArray(n)?"binary"===(null==t?void 0:t.type)?this.getFilteredSuggestions(null==t?void 0:t.value,o.VALUE):this.getFilteredSuggestions("",o.BINARY):"value"===(null==t?void 0:t.type)&&"unary"===(null==n?void 0:n.type)?this.getFilteredSuggestions(null==t?void 0:t.value,o.VALUE):"unary"===(null==t?void 0:t.type)?this.getFilteredSuggestions("",o.VALUE):"string"===(null==t?void 0:t.type)&&"value"===(null==n?void 0:n.type)?this.getFilteredSuggestions("",o.BINARY):"string"!==(null==t?void 0:t.type)||"string"!==(null==n?void 0:n.type)||null!=n&&n.value?("string"!==(null==n?void 0:n.type)||null!=t&&t.value)&&("value"!==(null==n?void 0:n.type)||null!=t&&t.value)&&"binary"!==(null==t?void 0:t.type)?this.getFilteredSuggestions(null==t?void 0:t.value,null==t?void 0:t.type):this.getFilteredSuggestions(null==t?void 0:t.value,o.BINARY):this.getFilteredSuggestions("",o.STRING)}},{key:"loadFieldValues",value:function(e){var t=this,n=[],r=e.split(" "),a=function(e){var a=r[e],i=n[n.length-1];if(i&&!Array.isArray(i)&&!i.value&&!a)return"continue";if(a.includes("!")&&a.split("!")[1]){var c=a.split("!")[1],l=t.getAllSuggestions().find((function(e){return e.value===c}));return l?(n.push([$[0],l]),"continue"):(n.push([$[0],{type:o.STRING,value:c}]),"continue")}var s=t.getAllSuggestions().find((function(e){return e.value===a}));if(s)return n.push(s),"continue";n.push({type:o.STRING,value:a})};for(var i in r)a(i);var c=this.getNewSuggestions(n);this.setState({fieldValues:n,activeSuggestion:0,suggestions:c})}},{key:"scrollToSuggestion",value:function(){var e,t,n=this.state,r=n.activeSuggestion,a=n.hideCaret;null===(e=this.suggestionList)||void 0===e||null===(t=e.current)||void 0===t||t.children[r].scrollIntoView({behavior:"smooth",block:"nearest",inline:"start"}),a||this.setState({hideCaret:!0})}},{key:"changeParentValue",value:function(){var e=this.props.onChange,t=this.state.fieldValues,n=[];for(var r in t){var a,i,o,c,l,s,u=t[r];if(Array.isArray(u))(null!==(a=u[0])&&void 0!==a&&a.value||null!==(i=u[1])&&void 0!==i&&i.value)&&n.push("".concat(null!==(o=null===(c=u[0])||void 0===c?void 0:c.value)&&void 0!==o?o:"").concat(null!==(l=null===(s=u[1])||void 0===s?void 0:s.value)&&void 0!==l?l:""));else n.push(u.value)}e(n.join(" "))}},{key:"getNewFieldValues",value:function(e){var t=L()(this.state.fieldValues),n=t[t.length-1];return Object(De.d)(n)?Array.isArray(n)?(t[t.length-1]=[n[0],e],t):("unary"===(null==n?void 0:n.type)&&(t[t.length-1]=[n,e]),"string"!==(null==n?void 0:n.type)||null!=n&&n.value||(t[t.length-1]=e),t):[e]}},{key:"checkPossiblyRegExMatchExpression",value:function(e){var t=this.props.isRegExMatchesSelected,n=this.state.help;if(t)n&&this.setState({help:""});else{var r=RegExp("^/.*/g?$").test(e);n?r||this.setState({help:Me}):r&&this.setState({help:Object(P.b)("You might want to change Data Type's value to 'Regex matches'")})}}},{key:"toggleSuggestions",value:function(e){this.setState({showSuggestions:e})}},{key:"render",value:function(){var e=this,t=this.props,n=t.error,r=t.value,a=t.onBlur,i=this.state,o=i.showSuggestions,c=i.suggestions,l=i.activeSuggestion,s=i.hideCaret,u=i.help;return Object(se.f)(We,{ref:this.selectorField,hideCaret:s},Object(se.f)(Be,{"data-test-id":"source-field",type:"text",label:Object(P.b)("Source"),name:"source",placeholder:Object(P.b)("Enter a custom attribute, variable or header name"),onChange:this.handleChange,autoComplete:"off",value:r,error:n,help:u,onKeyDown:this.handleKeyDown,onBlur:a,onFocus:this.handleFocus,inline:!1,flexibleControlStateSize:!0,stacked:!0,required:!0,showHelpInTooltip:!0}),o&&c.length>0&&Object(se.f)(I.a.Fragment,null,Object(se.f)(_e,{ref:this.suggestionList,error:n,"data-test-id":"source-suggestions"},c.slice(0,50).map((function(t,n){return Object(se.f)(Ye,{key:t.value,onClick:e.handleClickSuggestionItem(t),active:n===l,tabIndex:-1},Object(se.f)(Ce.a,null,t.value),t.description&&Object(se.f)(Ge,null,"(",Object(se.f)(Ce.a,null,t.description),")"),t.examples&&t.examples.length>0&&Object(se.f)(Ue,{examples:t.examples,sourceName:t.value}))}))),Object(se.f)(Xe,{onClick:this.handleClickOutside})))}}]),n}(I.a.Component);He.displayName="SourceField";var qe=He,We=Object(R.a)("div",{target:"ebdr9yc0",label:"Wrapper"})("position:relative;width:100%;",(function(e){return e.hideCaret&&"caret-color: transparent;"})),Be=Object(R.a)(Pe.a,{target:"ebdr9yc1",label:"StyledInput"})({name:"1wsr984",styles:"z-index:1002;:focus{outline:none;}"}),_e=Object(R.a)("ul",{target:"ebdr9yc2",label:"Suggestions"})("position:absolute;width:",(function(e){return e.error?"calc(100% - 34px)":"100%"}),";padding-left:0;list-style:none;margin-bottom:0;box-shadow:0 2px 0 rgba(37,11,54,0.04);border:1px solid ",(function(e){return e.theme.border}),";border-radius:0 0 ",Object(N.a)(.5)," ",Object(N.a)(.5),";background:",(function(e){return e.theme.background}),";top:63px;left:0;z-index:1002;overflow:hidden;max-height:200px;overflow-y:auto;"),Ye=Object(R.a)("li",{target:"ebdr9yc3",label:"Suggestion"})("display:grid;grid-template-columns:auto 1fr max-content;grid-gap:",Object(N.a)(1),";border-bottom:1px solid ",(function(e){return e.theme.border}),";padding:",Object(N.a)(1)," ",Object(N.a)(2),";font-size:",(function(e){return e.theme.fontSizeMedium}),";cursor:pointer;background:",(function(e){return e.active?e.theme.backgroundSecondary:e.theme.background}),";:hover{background:",(function(e){return e.active,e.theme.backgroundSecondary}),";}"),Ge=Object(R.a)("div",{target:"ebdr9yc4",label:"SuggestionDescription"})("display:flex;overflow:hidden;color:",(function(e){return e.theme.gray300}),";"),Xe=Object(R.a)("div",{target:"ebdr9yc5",label:"SuggestionsOverlay"})({name:"17x90tk",styles:"position:fixed;top:0;left:0;right:0;bottom:0;z-index:1001;"});function $e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ke(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$e(Object(n),!0).forEach((function(t){U()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$e(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Je(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}var Ze=function(e){y()(n,e);var t=Je(n);function n(){var e,r;b()(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(r=t.call.apply(t,[this].concat(i))).state={displayEventId:!(null===(e=r.props.eventId)||void 0===e||!e.value)},r.handleChange=function(e){return function(t){r.props.onChange(e,t.target.value)}},r.handleToggleEventId=function(){r.setState((function(e){return{displayEventId:!e.displayEventId}}))},r}return g()(n,[{key:"render",value:function(){var e=this.props,t=e.values,n=e.onChange,i=e.errors,o=e.onValidate,c=e.sourceSuggestions,l=e.onUpdateEventId,s=e.eventId,u=t.method,d=t.type,f=t.source,p=this.state.displayEventId;return Object(se.f)(I.a.Fragment,null,Object(se.f)(tt,{hasTwoColumns:t.method===a.REPLACE},Object(se.f)(te.a,{"data-test-id":"method-field",label:Object(P.b)("Method"),help:Object(P.b)("What to do"),inline:!1,flexibleControlStateSize:!0,stacked:!0,showHelpInTooltip:!0},Object(se.f)(Ae,{placeholder:Object(P.b)("Select method"),name:"method",options:Z()(Object.values(a)).map((function(e){return Ke(Ke({},G(e)),{},{value:e})})),value:u,onChange:function(e){return n("method",null==e?void 0:e.value)}})),t.method===a.REPLACE&&Object(se.f)(te.a,{"data-test-id":"placeholder-field",label:Object(P.b)("Custom Placeholder (Optional)"),help:Object(P.b)("It will replace the default placeholder [Filtered]"),inline:!1,flexibleControlStateSize:!0,stacked:!0,showHelpInTooltip:!0},Object(se.f)(ee.a,{type:"text",name:"placeholder",placeholder:"[".concat(Object(P.b)("Filtered"),"]"),onChange:this.handleChange("placeholder"),value:t.placeholder}))),Object(se.f)(tt,{hasTwoColumns:t.type===r.PATTERN},Object(se.f)(te.a,{"data-test-id":"type-field",label:Object(P.b)("Data Type"),help:Object(P.b)("What to look for. Use an existing pattern or define your own using regular expressions."),inline:!1,flexibleControlStateSize:!0,stacked:!0,showHelpInTooltip:!0},Object(se.f)(Ae,{placeholder:Object(P.b)("Select type"),name:"type",options:Z()(Object.values(r)).map((function(e){return{label:Y(e),value:e}})),value:d,onChange:function(e){return n("type",null==e?void 0:e.value)}})),t.type===r.PATTERN&&Object(se.f)(te.a,{"data-test-id":"regex-field",label:Object(P.b)("Regex matches"),help:Object(P.b)("Custom regular expression (see documentation)"),inline:!1,error:null==i?void 0:i.pattern,flexibleControlStateSize:!0,stacked:!0,required:!0,showHelpInTooltip:!0},Object(se.f)(rt,{type:"text",name:"pattern",placeholder:Object(P.b)("[a-zA-Z0-9]+"),onChange:this.handleChange("pattern"),value:t.pattern,onBlur:o("pattern")}))),Object(se.f)(at,null,p?Object(se.f)(it,{priority:"link",onClick:this.handleToggleEventId},Object(P.b)("Hide event ID field"),Object(se.f)(Q.j,{direction:"up",size:"xs"})):Object(se.f)(it,{priority:"link",onClick:this.handleToggleEventId},Object(P.b)("Use event ID for auto-completion"),Object(se.f)(Q.j,{direction:"down",size:"xs"}))),Object(se.f)(nt,{isExpanded:p},p&&Object(se.f)(ve,{onUpdateEventId:l,eventId:s}),Object(se.f)(qe,{onChange:function(e){return n("source",e)},value:f,error:null==i?void 0:i.source,onBlur:o("source"),isRegExMatchesSelected:d===r.PATTERN,suggestions:c})))}}]),n}(I.a.Component);Ze.displayName="Form";var Qe,et=Ze,tt=Object(R.a)("div",{target:"eq4269f0",label:"FieldGroup"})("display:grid;margin-bottom:",Object(N.a)(2),";@media (min-width:",(function(e){return e.theme.breakpoints[0]}),"){grid-gap:",Object(N.a)(2),";",(function(e){return e.hasTwoColumns&&"grid-template-columns: 1fr 1fr;"})," margin-bottom:",(function(e){return e.hasTwoColumns?0:Object(N.a)(2)}),";}"),nt=Object(R.a)("div",{target:"eq4269f1",label:"SourceGroup"})("height:65px;transition:all 300ms cubic-bezier(0.4,0,0.2,1) 0ms;transition-property:height;",(function(e){return e.isExpanded&&"\n    border-radius: ".concat(e.theme.borderRadius,";\n    border: 1px solid ").concat(e.theme.border,";\n    box-shadow: ").concat(e.theme.dropShadowLight,";\n    margin: ").concat(Object(N.a)(2)," 0 ").concat(Object(N.a)(3)," 0;\n    padding: ").concat(Object(N.a)(2),";\n    height: 180px;\n  ")})),rt=Object(R.a)(ee.a,{target:"eq4269f2",label:"RegularExpression"})("font-family:",(function(e){return e.theme.text.familyMono}),";"),at=Object(R.a)("div",{target:"eq4269f3",label:"ToggleWrapper"})({name:"1bvc4cc",styles:"display:flex;justify-content:flex-end;"}),it=Object(R.a)(k.b,{target:"eq4269f4",label:"Toggle"})("font-weight:700;color:",(function(e){return e.theme.subText}),";&:hover,&:focus{color:",(function(e){return e.theme.textColor}),";}> *:first-child{display:grid;grid-gap:",Object(N.a)(.5),";grid-template-columns:repeat(2,max-content);align-items:center;}");function ot(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return ct(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ct(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,c=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){c=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(c)throw i}}}}function ct(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}!function(e){e.Unknown="unknown",e.InvalidSelector="invalid-selector",e.RegexParse="regex-parse"}(Qe||(Qe={}));var lt=function(e){var t,n=null===(t=e.responseJSON)||void 0===t?void 0:t.relayPiiConfig[0];if(!n)return{type:Qe.Unknown,message:Object(P.b)("Unknown error occurred while saving data scrubbing rule")};if(n.startsWith("invalid selector: ")){var r,a=ot(n.split("\n"));try{for(a.s();!(r=a.n()).done;){var i=r.value;if(i.startsWith("1 | ")){var o=i.slice(3);return{type:Qe.InvalidSelector,message:Object(P.b)("Invalid source value: %s",o)}}}}catch(e){a.e(e)}finally{a.f()}}if(n.startsWith("regex parse error:")){var c,l=ot(n.split("\n"));try{for(l.s();!(c=l.n()).done;){var s=c.value;if(s.startsWith("error:")){var u=s.slice(6).replace(/at line \d+ column \d+/,"");return{type:Qe.RegexParse,message:Object(P.b)("Invalid regex: %s",u)}}}}catch(e){l.e(e)}finally{l.f()}}return{type:Qe.Unknown,message:Object(P.b)("An unknown error occurred while saving data scrubbing rule")}},st=n(75),ut=function(e){var t=e.title,n=e.onSave,r=e.content,a=e.disabled,i=e.Header,o=e.Body,c=e.Footer,l=e.closeModal;return Object(se.f)(I.a.Fragment,null,Object(se.f)(i,{closeButton:!0},Object(se.f)("span",{"data-test-id":"modal-title"},t)),Object(se.f)(o,null,r),Object(se.f)(c,null,Object(se.f)(st.a,{gap:1.5},Object(se.f)(k.b,{onClick:l},Object(P.b)("Cancel")),Object(se.f)(k.b,{onClick:n,disabled:a,priority:"primary"},Object(P.b)("Save Rule")))))};ut.displayName="Modal";var dt=ut;function ft(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function pt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ft(Object(n),!0).forEach((function(t){U()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ft(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function bt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}var ht=function(e){y()(o,e);var t,n=bt(o);function o(){var e;b()(this,o);for(var t=arguments.length,c=new Array(t),s=0;s<t;s++)c[s]=arguments[s];return(e=n.call.apply(n,[this].concat(c))).state=e.getDefaultState(),e.handleChange=function(t,n){var i=pt(pt({},e.state.values),{},U()({},t,n));i.type!==r.PATTERN&&i.pattern&&(i.pattern=""),i.method!==a.REPLACE&&i.placeholder&&(i.placeholder=""),e.setState((function(n){return{values:i,requiredValues:e.getRequiredValues(i),errors:W()(n.errors,t)}}))},e.handleSave=u()(l.a.mark((function t(){var n,r,a,i,o,c,s,u;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.props,r=n.endpoint,a=n.api,i=n.onSubmitSuccess,o=n.closeModal,c=n.onGetNewRules,s=c(e.state.values),t.prev=2,t.next=5,_(a,r,s);case 5:u=t.sent,i(u),o(),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(2),e.convertRequestError(lt(t.t0));case 13:case"end":return t.stop()}}),t,null,[[2,10]])}))),e.handleValidate=function(t){return function(){var n=!e.state.values[t].trim(),r=e.state.errors[t];n&&r||(!n||r?!n&&r&&e.clearError(t):e.setState((function(e){return{errors:pt(pt({},e.errors),{},U()({},t,Object(P.b)("Field Required")))}})))}},e.handleUpdateEventId=function(t){t!==e.state.eventId.value&&e.setState({eventId:{value:t,status:i.UNDEFINED}})},e}return g()(o,[{key:"componentDidMount",value:function(){this.handleValidateForm()}},{key:"componentDidUpdate",value:function(e,t){H()(t.values,this.state.values)||this.handleValidateForm(),t.eventId.value!==this.state.eventId.value&&this.loadSourceSuggestions(),t.eventId.status!==this.state.eventId.status&&oe(this.state.eventId,this.state.sourceSuggestions)}},{key:"getDefaultState",value:function(){var e=ie(),t=e.eventId,n=e.sourceSuggestions,r=this.getInitialValues();return{values:r,requiredValues:this.getRequiredValues(r),errors:{},isFormValid:!1,eventId:{value:t,status:t?i.LOADED:i.UNDEFINED},sourceSuggestions:n}}},{key:"getInitialValues",value:function(){var e,t,n,i,o,c=this.props.initialState;return{type:null!==(e=null==c?void 0:c.type)&&void 0!==e?e:r.CREDITCARD,method:null!==(t=null==c?void 0:c.method)&&void 0!==t?t:a.MASK,source:null!==(n=null==c?void 0:c.source)&&void 0!==n?n:"",placeholder:null!==(i=null==c?void 0:c.placeholder)&&void 0!==i?i:"",pattern:null!==(o=null==c?void 0:c.pattern)&&void 0!==o?o:""}}},{key:"getRequiredValues",value:function(e){var t=["type","method","source"];return e.type===r.PATTERN&&t.push("pattern"),t}},{key:"clearError",value:function(e){this.setState((function(t){return{errors:W()(t.errors,e)}}))}},{key:"loadSourceSuggestions",value:(t=u()(l.a.mark((function e(){var t,n,r,a,o,c,s,u;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.props,n=t.orgSlug,r=t.projectId,a=t.api,(o=this.state.eventId).value){e.next=5;break}return this.setState((function(e){return{sourceSuggestions:K,eventId:pt(pt({},e.eventId),{},{status:i.UNDEFINED})}})),e.abrupt("return");case 5:return this.setState((function(e){return{sourceSuggestions:K,eventId:pt(pt({},e.eventId),{},{status:i.LOADING})}})),e.prev=6,c={eventId:o.value},r&&(c.projectId=r),e.next=11,a.requestPromise("/organizations/".concat(n,"/data-scrubbing-selector-suggestions/"),{query:c});case 11:if(s=e.sent,!((u=s.suggestions)&&u.length>0)){e.next=16;break}return this.setState((function(e){return{sourceSuggestions:u,eventId:pt(pt({},e.eventId),{},{status:i.LOADED})}})),e.abrupt("return");case 16:this.setState((function(e){return{sourceSuggestions:K,eventId:pt(pt({},e.eventId),{},{status:i.NOT_FOUND})}})),e.next=22;break;case 19:e.prev=19,e.t0=e.catch(6),this.setState((function(e){return{eventId:pt(pt({},e.eventId),{},{status:i.ERROR})}}));case 22:case"end":return e.stop()}}),e,this,[[6,19]])}))),function(){return t.apply(this,arguments)})},{key:"convertRequestError",value:function(e){switch(e.type){case Qe.InvalidSelector:this.setState((function(t){return{errors:pt(pt({},t.errors),{},{source:e.message})}}));break;case Qe.RegexParse:this.setState((function(t){return{errors:pt(pt({},t.errors),{},{pattern:e.message})}}));break;default:Object(w.a)(e.message)}}},{key:"handleValidateForm",value:function(){var e=this.state,t=e.values,n=e.requiredValues.every((function(e){return!!t[e]}));this.setState({isFormValid:n})}},{key:"render",value:function(){var e=this.state,t=e.values,n=e.errors,r=e.isFormValid,a=e.eventId,i=e.sourceSuggestions,o=this.props.title;return Object(se.f)(dt,f()({},this.props,{title:o,onSave:this.handleSave,disabled:!r,content:Object(se.f)(et,{onChange:this.handleChange,onValidate:this.handleValidate,onUpdateEventId:this.handleUpdateEventId,eventId:a,errors:n,values:t,sourceSuggestions:i})}))}}]),o}(I.a.Component);ht.displayName="ModalManager";var gt=ht;function vt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function yt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?vt(Object(n),!0).forEach((function(t){U()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):vt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ot=function(e){var t=e.savedRules,n=z()(e,["savedRules"]);return Object(se.f)(gt,f()({},n,{savedRules:t,title:Object(P.b)("Add an advanced data scrubbing rule"),onGetNewRules:function(e){return[].concat(L()(t),[yt(yt({},e),{},{id:t.length})])}}))};Ot.displayName="Add";var jt=Ot;function mt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function St(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?mt(Object(n),!0).forEach((function(t){U()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):mt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Rt=function(e){var t=e.savedRules,n=e.rule,r=z()(e,["savedRules","rule"]);return Object(se.f)(gt,f()({},r,{savedRules:t,title:Object(P.b)("Edit an advanced data scrubbing rule"),initialState:n,onGetNewRules:function(e){var r=St(St({},e),{},{id:n.id});return t.map((function(e){return e.id===r.id?r:e}))}}))};Rt.displayName="Edit";var Et=Rt,It=n(433),wt=I.a.forwardRef((function(e,t){var n=e.rules,i=e.onEditRule,o=e.onDeleteRule,c=e.disabled;return Object(se.f)(At,{ref:t,isDisabled:c,"data-test-id":"advanced-data-scrubbing-rules"},n.map((function(e){var t=e.id;return Object(se.f)(xt,{key:t},Object(se.f)(Ce.a,null,function(e){var t=e.method,n=e.type,i=e.source,o=G(t),c=Y(n),l=[];return l.push("[".concat(o.label,"]")),l.push(e.type===r.PATTERN?"[".concat(e.pattern,"]"):"[".concat(c,"]")),e.method===a.REPLACE&&e.placeholder&&l.push(" with [".concat(e.placeholder,"]")),"".concat(l.join(" ")," ").concat(Object(P.b)("from")," [").concat(i,"]")}(e)),i&&Object(se.f)(k.b,{label:Object(P.b)("Edit Rule"),size:"small",onClick:i(t),icon:Object(se.f)(Q.u,null),disabled:c}),o&&Object(se.f)(k.b,{label:Object(P.b)("Delete Rule"),size:"small",onClick:o(t),icon:Object(se.f)(Q.r,null),disabled:c}))})))})),At=Object(R.a)("ul",{target:"egdl72c0",label:"List"})("list-style:none;margin:0;padding:0;margin-bottom:0 !important;",(function(e){return e.isDisabled&&"\n      color: ".concat(e.theme.gray200,";\n      background: ").concat(e.theme.backgroundSecondary,";\n  ")})),xt=Object(R.a)("li",{target:"egdl72c1",label:"ListItem"})("display:grid;grid-template-columns:auto max-content max-content;grid-column-gap:",Object(N.a)(1),";align-items:center;padding:",Object(N.a)(1)," ",Object(N.a)(2),";border-bottom:1px solid ",(function(e){return e.theme.border}),";&:hover{background-color:",(function(e){return e.theme.backgroundSecondary}),";}&:last-child{border-bottom:0;}"),kt=function(e){var t=e.rules,n=e.disabled,r=e.onDeleteRule,a=e.onEditRule;return 0===t.length?Object(se.f)(It.a,{icon:Object(se.f)(Q.Ib,{size:"xl"}),description:Object(P.b)("You have no data scrubbing rules")}):Object(se.f)(wt,{rules:t,onDeleteRule:r,onEditRule:a,disabled:n})};kt.displayName="Content";var Ct=kt,Dt=n(29),Pt=n.n(Dt);function Nt(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Tt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Tt(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,c=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){c=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(c)throw i}}}}function Tt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ut=function(e){var t=e?JSON.parse(e):{},n=t.rules||{},i=t.applications||{},o=[];for(var c in i){var l,s=Nt(i[c]);try{for(s.s();!(l=s.n()).done;){var u=l.value,d=n[u],f=o.length,p=c;if(d){var b=d.type,h=d.redaction,g=h.method;g!==a.REPLACE||d.type!==r.PATTERN?g!==a.REPLACE?d.type!==r.PATTERN?o.push({id:f,method:g,type:b,source:p}):o.push({id:f,method:g,type:r.PATTERN,source:p,pattern:d.pattern}):o.push({id:f,method:a.REPLACE,type:b,source:p,placeholder:null==h?void 0:h.text}):o.push({id:f,method:a.REPLACE,type:r.PATTERN,source:p,placeholder:null==h?void 0:h.text,pattern:d.pattern})}else if("@"===u[0]){var v=u.slice(1).split(":"),y=Pt()(v,1)[0],O=Pt()(v,2)[1];"urlauth"===y&&(y="url_auth"),"usssn"===y&&(y="us_ssn"),o.push({id:f,method:O,type:y,source:p})}}}catch(e){s.e(e)}finally{s.f()}}return o};function Vt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}var Lt=function(e){y()(n,e);var t=Vt(n);function n(){var e;b()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).state={isCollapsed:!0},e.rulesRef=I.a.createRef(),e.handleToggleCollapsed=function(){e.setState((function(e){return{isCollapsed:!e.isCollapsed}}))},e}return g()(n,[{key:"componentDidUpdate",value:function(){this.loadContentHeight()}},{key:"loadContentHeight",value:function(){if(!this.state.contentHeight){var e,t=null===(e=this.rulesRef.current)||void 0===e?void 0:e.offsetHeight;t&&this.setState({contentHeight:"".concat(t,"px")})}}},{key:"render",value:function(){var e=this.props.rules,t=this.state,n=t.isCollapsed,r=t.contentHeight;return 0===e.length?Object(se.f)(Ht,null,Object(P.b)("There are no data scrubbing rules at the organization level")):Object(se.f)(Ht,{isCollapsed:n,contentHeight:r},Object(se.f)(Mt,{onClick:this.handleToggleCollapsed},Object(se.f)("div",null,Object(P.b)("Organization Rules")),Object(se.f)(k.b,{title:n?Object(P.b)("Expand Organization Rules"):Object(P.b)("Collapse Organization Rules"),icon:Object(se.f)(Q.j,{size:"xs",direction:n?"down":"up"}),size:"xsmall"})),Object(se.f)(zt,null,Object(se.f)(wt,{rules:e,ref:this.rulesRef,disabled:!0})))}}]),n}(I.a.Component);Lt.displayName="OrganizationRules";var Ft=Lt,zt=Object(R.a)("div",{target:"ei0za3e0",label:"Content"})({name:"pq5vrk",styles:"transition:height 300ms cubic-bezier(0.4,0,0.2,1) 0ms;height:0;overflow:hidden;"}),Mt=Object(R.a)("div",{target:"ei0za3e1",label:"Header"})("cursor:pointer;display:grid;grid-template-columns:1fr auto;align-items:center;border-bottom:1px solid ",(function(e){return e.theme.border}),";padding:",Object(N.a)(1)," ",Object(N.a)(2),";"),Ht=Object(R.a)("div",{target:"ei0za3e2",label:"Wrapper"})("color:",(function(e){return e.theme.gray200}),";background:",(function(e){return e.theme.backgroundSecondary}),";",(function(e){return!e.contentHeight&&"padding: ".concat(Object(N.a)(1)," ").concat(Object(N.a)(2))}),";",(function(e){return!e.isCollapsed&&" border-bottom: 1px solid ".concat(e.theme.border)}),";",(function(e){return!e.isCollapsed&&e.contentHeight&&"\n      ".concat(zt," {\n        height: ").concat(e.contentHeight,";\n      }\n    ")}));function qt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}var Wt=function(e){y()(n,e);var t=qt(n);function n(){var e;b()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).state={rules:[],savedRules:[],relayPiiConfig:e.props.relayPiiConfig,orgRules:[]},e.api=new x.a,e.handleOpenAddModal=function(){var t=e.state.rules;Object(A.j)((function(n){return Object(se.f)(jt,f()({},n,{projectId:e.props.projectId,savedRules:t,api:e.api,endpoint:e.props.endpoint,orgSlug:e.props.organization.slug,onSubmitSuccess:function(t){e.successfullySaved(t,Object(P.b)("Successfully added data scrubbing rule"))}}))}))},e.handleOpenEditModal=function(t){return function(){var n=e.state.rules;Object(A.j)((function(r){return Object(se.f)(Et,f()({},r,{rule:n[t],projectId:e.props.projectId,savedRules:n,api:e.api,endpoint:e.props.endpoint,orgSlug:e.props.organization.slug,onSubmitSuccess:function(t){e.successfullySaved(t,Object(P.b)("Successfully updated data scrubbing rule"))}}))}))}},e.handleDelete=function(t){return u()(l.a.mark((function n(){var r,a,i,o;return l.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=e.state.rules,a=r.filter((function(e){return e.id!==t})),n.prev=2,n.next=5,_(e.api,e.props.endpoint,a);case 5:null!=(i=n.sent)&&i.relayPiiConfig&&(o=Ut(i.relayPiiConfig),e.setState({rules:o}),Object(w.c)(Object(P.b)("Successfully deleted data scrubbing rule"))),n.next=12;break;case 9:n.prev=9,n.t0=n.catch(2),Object(w.a)(Object(P.b)("An unknown error occurred while deleting data scrubbing rule"));case 12:case"end":return n.stop()}}),n,null,[[2,9]])})))},e}return g()(n,[{key:"componentDidMount",value:function(){this.loadRules(),this.loadOrganizationRules()}},{key:"componentDidUpdate",value:function(e,t){t.relayPiiConfig!==this.state.relayPiiConfig&&this.loadRules()}},{key:"componentWillUnmount",value:function(){this.api.clear()}},{key:"loadOrganizationRules",value:function(){var e=this.props,t=e.organization;if(e.projectId)try{this.setState({orgRules:Ut(t.relayPiiConfig)})}catch(e){Object(w.a)(Object(P.b)("Unable to load organization rules"))}}},{key:"loadRules",value:function(){try{var e=Ut(this.state.relayPiiConfig);this.setState({rules:e,savedRules:e})}catch(e){Object(w.a)(Object(P.b)("Unable to load project rules"))}}},{key:"successfullySaved",value:function(e,t){var n=this.props.onSubmitSuccess;this.setState({rules:Ut(e.relayPiiConfig)}),Object(w.c)(t),null==n||n(e)}},{key:"render",value:function(){var e=this.props,t=e.additionalContext,n=e.disabled,r=e.projectId,a=this.state,i=a.orgRules,o=a.rules;return Object(se.f)(I.a.Fragment,null,Object(se.f)(D.a,{"data-test-id":"advanced-data-scrubbing"},Object(se.f)(D.e,null,Object(se.f)("div",null,Object(P.b)("Advanced Data Scrubbing"))),Object(se.f)(D.b,{type:"info"},t," ","".concat(Object(P.b)("The new rules will only apply to upcoming events. "))," ",Object(P.c)("For more details, see [linkToDocs].",{linkToDocs:Object(se.f)(C.a,{href:"https://docs.sentry.io/data-management/advanced-datascrubbing/"},Object(P.b)("full documentation on data scrubbing"))})),Object(se.f)(D.c,null,r&&Object(se.f)(Ft,{rules:i}),Object(se.f)(Ct,{rules:o,onDeleteRule:this.handleDelete,onEditRule:this.handleOpenEditModal,disabled:n}),Object(se.f)(Bt,null,Object(se.f)(k.b,{href:"https://docs.sentry.io/data-management/advanced-datascrubbing/",target:"_blank"},Object(P.b)("Read the docs")),Object(se.f)(k.b,{disabled:n,onClick:this.handleOpenAddModal,priority:"primary"},Object(P.b)("Add Rule"))))))}}]),n}(I.a.Component);Wt.displayName="DataScrubbing";t.a=Wt;var Bt=Object(R.a)("div",{target:"e1kw79fb0",label:"PanelAction"})("padding:",Object(N.a)(1)," ",Object(N.a)(2),";position:relative;display:grid;grid-gap:",Object(N.a)(1),";grid-template-columns:auto auto;justify-content:flex-end;border-top:1px solid ",(function(e){return e.theme.border}),";")}}]);
//# sourceMappingURL=OrganizationSecurityAndPrivacy~ProjectSecurityAndPrivacy.js.map