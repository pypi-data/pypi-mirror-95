(window.sntryWpJsonp=window.sntryWpJsonp||[]).push([[63],{1923:function(e,t,r){"use strict";r(1);var n=r(264),a=r.n(n),i=r(0),o=function(e){var t="".concat(e.title," - ").concat(e.objSlug," - Sentry");return Object(i.f)(a.a,{title:t},e.children)};o.displayName="SentryDocumentTitle",t.a=o},2027:function(e,t,r){"use strict";r.d(t,"a",(function(){return I}));var n=r(5),a=r.n(n),i=r(8),o=r.n(i),c=r(14),s=r.n(c),l=r(24),u=r.n(l),f=r(3),b=r(1),d=r.n(b),p=r(22),j=r(445),O=r(432),g=r(70),m=r(26),h=r(69),y=r(15),v=r(2),w=r(62),k=r(2001),S=r(2036),x=r(0);function z(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function P(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?z(Object(r),!0).forEach((function(t){o()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):z(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function A(e){var t=e.incompatibleQuery,r=e.eventView,n=e.orgId,a=e.onClose,i=t.hasProjectError,o=t.hasEnvironmentError,c=t.hasEventTypeError,s=t.hasYAxisError,l=Object.values(t).filter((function(e){return!0===e})).length,u=r.clone();u.query+=" event.type:error";var f=r.clone();f.query+=" event.type:transaction";var b=r.clone();b.query+=" event.type:default";var p=r.clone();p.query+=" event.type:error or event.type:default";var j="/organizations/".concat(n,"/discover/results/"),O={error:Object(x.f)(h.a,{to:{pathname:j,query:u.generateQueryStringObject()}}),default:Object(x.f)(h.a,{to:{pathname:j,query:b.generateQueryStringObject()}}),transaction:Object(x.f)(h.a,{to:{pathname:j,query:f.generateQueryStringObject()}}),errorDefault:Object(x.f)(h.a,{to:{pathname:j,query:p.generateQueryStringObject()}})};return Object(x.f)(q,{type:"warning",icon:Object(x.f)(y.J,{color:"yellow300",size:"sm"})},1===l&&Object(x.f)(d.a.Fragment,null,i&&Object(v.b)("An alert can use data from only one Project. Select one and try again."),o&&Object(v.b)("An alert supports data from a single Environment or All Environments. Pick one try again."),c&&Object(v.c)("An alert needs a filter of [error:event.type:error], [default:event.type:default], [transaction:event.type:transaction], [errorDefault:(event.type:error OR event.type:default)]. Use one of these and try again.",O),s&&Object(v.c)("An alert can’t use the metric [yAxis] just yet. Select another metric and try again.",{yAxis:Object(x.f)(E,null,r.getYAxis())})),l>1&&Object(x.f)(d.a.Fragment,null,Object(v.b)("Yikes! That button didn’t work. Please fix the following problems:"),Object(x.f)(D,null,i&&Object(x.f)("li",null,Object(v.b)("Select one Project.")),o&&Object(x.f)("li",null,Object(v.b)("Select a single Environment or All Environments.")),c&&Object(x.f)("li",null,Object(v.c)("Use the filter [error:event.type:error], [default:event.type:default], [transaction:event.type:transaction], [errorDefault:(event.type:error OR event.type:default)].",O)),s&&Object(x.f)("li",null,Object(v.c)("An alert can’t use the metric [yAxis] just yet. Select another metric and try again.",{yAxis:Object(x.f)(E,null,r.getYAxis())})))),Object(x.f)(L,{icon:Object(x.f)(y.n,{color:"yellow300",size:"sm",isCircled:!0}),"aria-label":Object(v.b)("Close"),size:"zero",onClick:a,borderless:!0}))}function I(e){var t=e.projects,r=e.eventView,n=e.organization,i=e.referrer,o=e.onIncompatibleQuery,c=e.onSuccess,l=s()(e,["projects","eventView","organization","referrer","onIncompatibleQuery","onSuccess"]),f={hasProjectError:1!==r.project.length||-1===r.project[0],hasEnvironmentError:r.environment.length>1,hasEventTypeError:null===Object(k.j)(r.query),hasYAxisError:function(e){var t,r=Object(w.j)(e.getYAxis());if("field"===r.kind)return!0;var n=e.query.match(/event\.type:(transaction|error)/);if(!n)return!1;var a="error"===n[1]?S.g:S.h,i=!a.aggregations.includes(r.function[0]),o=w.a[r.function[0]];if(!o)return!1;var c=o.parameters.some((function(e){return"value"===e.kind&&"number"===e.dataType})),s=[""].concat(u()(a.fields),u()(null!==(t=a.measurementKeys)&&void 0!==t?t:[])),l=!c&&!s.includes(r.function[1]);return i||l}(r)},b=t.find((function(e){return e.id==="".concat(r.project[0])})),d=Object.values(f).some((function(e){return e})),p=d?void 0:{pathname:"/organizations/".concat(n.slug,"/alerts/").concat(null==b?void 0:b.slug,"/new/"),query:P(P({},r.generateQueryStringObject()),{},{createFromDiscover:!0,referrer:i})};return Object(x.f)(R,a()({organization:n,onClick:function(e){if(d)return e.preventDefault(),void o((function(e){return Object(x.f)(A,{incompatibleQuery:f,eventView:r,orgId:n.slug,onClose:e})}),f);c()},to:p},l))}A.displayName="IncompatibleQueryAlert",I.displayName="CreateAlertFromViewButton";var R=Object(p.withRouter)((function(e){var t=e.organization,r=e.projectSlug,n=e.iconProps,i=e.referrer,o=e.router,c=e.hideIcon,l=s()(e,["organization","projectSlug","iconProps","referrer","router","hideIcon"]);function u(e){e.preventDefault(),Object(j.a)("/organizations/".concat(t.slug,"/alerts/:projectId/new/").concat(i?"?referrer=".concat(i):""),o)}return Object(x.f)(O.a,{organization:t,access:["alerts:write"]},(function(e){var i,o=e.hasAccess;return Object(x.f)(m.b,a()({disabled:!o,title:o?void 0:Object(v.b)("Users with admin permission or higher can create alert rules."),icon:!c&&Object(x.f)(y.qb,n),to:r?"/organizations/".concat(t.slug,"/alerts/").concat(r,"/new/"):void 0,onClick:r?void 0:u},l),null!==(i=l.children)&&void 0!==i?i:Object(v.b)("Create Alert"))}))}));t.b=R;var q=Object(f.a)(g.b,{target:"efj2j700",label:"StyledAlert"})("color:",(function(e){return e.theme.textColor}),";margin-bottom:0;"),D=Object(f.a)("ul",{target:"efj2j701",label:"StyledUnorderedList"})({name:"gx0lhm",styles:"margin-bottom:0;"}),E=Object(f.a)("code",{target:"efj2j702",label:"StyledCode"})({name:"18n1sg8",styles:"background-color:transparent;padding:0;"}),L=Object(f.a)(m.b,{target:"efj2j703",label:"StyledCloseButton"})({name:"1f7txv4",styles:"transition:opacity 0.1s linear;position:absolute;top:3px;right:0;&:hover,&:focus{background-color:transparent;opacity:1;}"})},2070:function(e,t,r){"use strict";r.d(t,"b",(function(){return f})),r.d(t,"a",(function(){return b}));var n=r(21),a=r.n(n),i=r(8),o=r.n(i),c=r(30),s=r.n(c);function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){o()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function f(e,t){return e.requestPromise("/prompts-activity/",{method:"PUT",data:{organization_id:t.organizationId,project_id:t.projectId,feature:t.feature,status:t.status}})}function b(e,t){return d.apply(this,arguments)}function d(){return(d=s()(a.a.mark((function e(t,r){var n,i,o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=u({feature:r.feature,organization_id:r.organizationId},void 0===r.projectId?{}:{project_id:r.projectId}),e.next=3,t.requestPromise("/prompts-activity/",{query:n});case 3:if(i=e.sent,o=null==i?void 0:i.data){e.next=7;break}return e.abrupt("return",null);case 7:return e.abrupt("return",{dismissedTime:o.dismissed_ts,snoozedTime:o.snoozed_ts});case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},2072:function(e,t,r){"use strict";var n=r(3),a=(r(1),r(96)),i=r(7),o=r(0);function c(e){var t=e.className,r=e.image,n=e.children;return Object(o.f)(a.a,{className:t},Object(o.f)(s,null,Object(o.f)(u,null,r),Object(o.f)(l,null,n)))}c.displayName="OnboardingPanel";var s=Object(n.a)("div",{target:"eipqko00",label:"Container"})("padding:",Object(i.a)(3),";position:relative;@media (min-width:",(function(e){return e.theme.breakpoints[0]}),"){display:flex;align-items:center;flex-direction:row;justify-content:center;flex-wrap:wrap;min-height:300px;max-width:1000px;margin:0 auto;}@media (min-width:",(function(e){return e.theme.breakpoints[1]}),"){min-height:350px;}"),l=Object(n.a)("div",{target:"eipqko01",label:"StyledBox"})("z-index:1;@media (min-width:",(function(e){return e.theme.breakpoints[0]}),"){flex:2;}"),u=Object(n.a)(l,{target:"eipqko02",label:"IlloBox"})("position:relative;min-height:100px;max-width:300px;margin:",Object(i.a)(2)," auto;@media (min-width:",(function(e){return e.theme.breakpoints[0]}),"){flex:1;margin:",Object(i.a)(3),";max-width:auto;}");t.a=c},2284:function(e,t,r){"use strict";var n=r(3),a=r(1),i=r.n(a),o=r(445),c=r(129),s=r(26),l=r(75),u=r(2027),f=r(296),b=r(69),d=r(15),p=r(2),j=r(7),O=r(0),g=function(e){var t=e.router,r=e.organization,n=e.activeTab;return Object(O.f)(i.a.Fragment,null,Object(O.f)(m,null,Object(O.f)(h,null,Object(O.f)(y,null,Object(p.b)("Alerts"))),Object(O.f)(f.c,null,Object(O.f)(w,{gap:1},Object(O.f)(s.b,{size:"small",onClick:function(e){e.preventDefault(),Object(o.a)("/settings/".concat(r.slug,"/projects/:projectId/alerts/"),t)},href:"#",icon:Object(O.f)(d.ob,{size:"xs"})},Object(p.b)("Settings")),Object(O.f)(u.b,{organization:r,iconProps:{size:"xs"},size:"small",priority:"primary",referrer:"alert_stream"},Object(p.b)("Create Alert Rule"))))),Object(O.f)(v,null,Object(O.f)(f.e,{underlined:!0},Object(O.f)(c.a,{features:["incidents"],organization:r},Object(O.f)("li",{className:"stream"===n?"active":""},Object(O.f)(b.a,{to:"/organizations/".concat(r.slug,"/alerts/")},Object(p.b)("Metric Alerts")))),Object(O.f)("li",{className:"rules"===n?"active":""},Object(O.f)(b.a,{to:"/organizations/".concat(r.slug,"/alerts/rules/")},Object(p.b)("Alert Rules"))))))};g.displayName="AlertHeader",t.a=g;var m=Object(n.a)(f.b,{target:"eorj8dc0",label:"BorderlessHeader"})("border-bottom:0;@media (max-width:",(function(e){return e.theme.breakpoints[1]}),"){flex-direction:row;}"),h=Object(n.a)(f.d,{target:"eorj8dc1",label:"StyledLayoutHeaderContent"})("margin-bottom:0;margin-right:",Object(j.a)(2),";"),y=Object(n.a)(f.h,{target:"eorj8dc2",label:"StyledLayoutTitle"})("margin-top:",Object(j.a)(.5),";"),v=Object(n.a)(f.b,{target:"eorj8dc3",label:"TabLayoutHeader"})("padding-top:",Object(j.a)(1),";@media (max-width:",(function(e){return e.theme.breakpoints[1]}),"){padding-top:",Object(j.a)(1),";}"),w=Object(n.a)(l.a,{target:"eorj8dc4",label:"Actions"})({name:"xgff9b",styles:"height:32px;"})},2758:function(e,t,r){e.exports=r.p+"alerts-empty-state.9078ef.svg"},2888:function(e,t,r){"use strict";r.r(t);var n=r(21),a=r.n(n),i=r(30),o=r.n(i),c=r(8),s=r.n(c),l=r(9),u=r.n(l),f=r(10),b=r.n(f),d=r(11),p=r.n(d),j=r(12),O=r.n(j),g=r(6),m=r.n(g),h=r(3),y=r(1),v=r.n(y),w=r(573),k=r.n(w),S=r(113),x=r.n(S),z=r(2070),P=r(129),A=r(70),I=r(704),R=r(26),q=r(75),D=r(2027),E=r(296),L=r(43),C=r(42),N=r(713),T=r(705),B=r(96),V=r(1923),_=r(15),Q=r(2),F=r(7),U=r(37),W=r(226),Y=r(57),H=r(433),M=r(2284),G=r(2758),J=r.n(G),X=r(2072),K=r(0);function Z(e){var t=e.actions;return Object(K.f)(X.a,{image:Object(K.f)($,{src:J.a})},Object(K.f)("h3",null,Object(Q.b)("More signal, less noise")),Object(K.f)("p",null,Object(Q.b)("Not every error is worth an email. Set your own rules for alerts you need, with information that helps.")),Object(K.f)(ee,{gap:1},t))}Z.displayName="Onboarding";var $=Object(h.a)("img",{target:"e1ljbtxe0",label:"AlertsImage"})("@media (min-width:",(function(e){return e.theme.breakpoints[0]}),"){user-select:none;position:absolute;top:0;bottom:0;width:220px;margin-top:auto;margin-bottom:auto;transform:translateX(-50%);left:50%;}@media (min-width:",(function(e){return e.theme.breakpoints[2]}),"){transform:translateX(-60%);width:280px;}@media (min-width:",(function(e){return e.theme.breakpoints[3]}),"){transform:translateX(-75%);width:320px;}"),ee=Object(h.a)(q.a,{target:"e1ljbtxe1",label:"ButtonList"})({name:"1tuvsuv",styles:"grid-template-columns:repeat(auto-fit,minmax(130px,max-content));"}),te=Z,re=r(378),ne=r.n(re),ae=r(41),ie=r.n(ae),oe=r(440),ce=r(156),se=r(183),le=r(69),ue=r(116),fe=r(31),be=r(44),de=r(208),pe=r(33),je=r(2053),Oe=r(2001),ge=r(29),me=r.n(ge),he=r(240);function ye(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=m()(e);if(t){var a=m()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return O()(this,r)}}var ve=v.a.lazy((function(){return Promise.all([r.e(6),r.e(197)]).then(r.bind(null,2055))})),we=v.a.lazy((function(){return Promise.all([r.e(6),r.e(198)]).then(r.bind(null,2056))})),ke=function(e){p()(r,e);var t=ye(r);function r(){return u()(this,r),t.apply(this,arguments)}return b()(r,[{key:"render",value:function(){var e=this.props,t=e.className,r=e.error,n=e.eventStats;if(r)return Object(K.f)(ze,{error:r});if(!n)return Object(K.f)(xe,null);var a=n.data.map((function(e){var t=me()(e,2)[1];return t&&Array.isArray(t)&&t.length&&t[0].count||0}));return Object(K.f)(v.a.Suspense,{fallback:Object(K.f)(xe,null)},Object(K.f)("div",{"data-test-id":"incident-sparkline",className:t},Object(K.f)(ve,{data:a,width:100,height:32},Object(K.f)(we,{style:{stroke:pe.b.gray300,fill:"none",strokeWidth:2}}))))}}]),r}(v.a.Component);ke.displayName="SparkLine";var Se=Object(h.a)(ke,{target:"e1ut8dj0",label:"StyledSparkLine"})("flex-shrink:0;width:100%;height:",38,"px;"),xe=Object(h.a)(he.a,{target:"e1ut8dj1",label:"SparkLinePlaceholder"})("height:",38,"px;"),ze=Object(h.a)(xe,{target:"e1ut8dj2",label:"SparklineError"})({name:"mp4ek8",styles:"align-items:center;line-height:1;"}),Pe=Se,Ae=Object(h.a)("div",{target:"e1k7qk1w0",label:"TableLayout"})("display:grid;grid-template-columns:",(function(e){return"open"===e.status?"4fr 1fr 2fr":"3fr 2fr 2fr 1fr 2fr"}),";grid-column-gap:",Object(F.a)(1.5),";width:100%;align-items:center;"),Ie=Object(h.a)("div",{target:"e1k7qk1w1",label:"TitleAndSparkLine"})("display:",(function(e){return"open"===e.status?"grid":"flex"}),";grid-gap:",Object(F.a)(1),";grid-template-columns:auto 120px;align-items:center;padding-right:",Object(F.a)(2),";overflow:hidden;");function Re(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=m()(e);if(t){var a=m()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return O()(this,r)}}var qe=function(e){p()(r,e);var t=Re(r);function r(){var e;u()(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).getProject=ne()((function(e,t){return t.find((function(t){return t.slug===e}))})),e}return b()(r,[{key:"getEndpoints",value:function(){var e=this.props,t=e.orgId,r=e.incident;return"open"===e.filteredStatus?[["stats","/organizations/".concat(t,"/incidents/").concat(r.identifier,"/stats/")]]:[]}},{key:"renderLoading",value:function(){return this.renderBody()}},{key:"renderError",value:function(){return this.renderBody()}},{key:"renderTimeSince",value:function(e){return Object(K.f)(Ee,null,Object(K.f)(ue.a,{date:e}))}},{key:"renderStatusIndicator",value:function(){var e=this.props.incident.status,t=e===je.c.CLOSED,r=e===je.c.WARNING,n=t?pe.b.gray200:r?pe.b.orange300:pe.b.red200,a=t?Object(Q.b)("Resolved"):r?Object(Q.b)("Warning"):Object(Q.b)("Critical");return Object(K.f)(fe.a,{title:Object(Q.c)("Status: [text]",{text:a})},Object(K.f)(Ce,{color:n}))}},{key:"renderBody",value:function(){var e=this.props,t=e.incident,r=e.orgId,n=e.projectsLoaded,a=e.projects,i=e.filteredStatus,o=this.state,c=o.error,s=o.stats,l=ie()(t.dateStarted),u=ie.a.duration(ie()(t.dateClosed||new Date).diff(l)).as("seconds"),f=t.projects[0];return Object(K.f)(ce.a,null,Object(K.f)(Be,null,Object(K.f)(Ae,{status:i},Object(K.f)(Ie,{status:i},Object(K.f)(Ne,null,this.renderStatusIndicator(),Object(K.f)(Te,{to:"/organizations/".concat(r,"/alerts/").concat(t.identifier,"/")},"Alert #",t.id),t.title),"open"===i&&Object(K.f)(Pe,{error:c&&Object(K.f)(De,null),eventStats:null==s?void 0:s.eventStats})),Object(K.f)(Le,{avatarSize:18,project:n?this.getProject(f,a):{slug:f}}),this.renderTimeSince(t.dateStarted),"closed"===i&&Object(K.f)(oe.a,{seconds:Object(de.a)({value:u,fixed:1200})}),"closed"===i&&t.dateClosed&&this.renderTimeSince(t.dateClosed))))}},{key:"metricPreset",get:function(){var e=this.props.incident;return e?Object(Oe.h)(e):void 0}}]),r}(I.a);function De(){return Object(K.f)(fe.a,{title:Object(Q.b)("Error loading alert stats")},Object(K.f)(_.Ib,null))}De.displayName="ErrorLoadingStatsIcon";var Ee=Object(h.a)("div",{target:"e12tl7g20",label:"CreatedResolvedTime"})(be.a," line-height:1.4;display:flex;align-items:center;"),Le=Object(h.a)(se.a,{target:"e12tl7g21",label:"ProjectBadge"})({name:"6su6fj",styles:"flex-shrink:0;"}),Ce=Object(h.a)("div",{target:"e12tl7g22",label:"StatusIndicator"})("width:10px;height:12px;background:",(function(e){return e.color}),";display:inline-block;border-top-right-radius:40%;border-bottom-right-radius:40%;margin-bottom:-1px;"),Ne=Object(h.a)("span",{target:"e12tl7g23",label:"Title"})(be.a),Te=Object(h.a)(le.a,{target:"e12tl7g24",label:"IncidentLink"})("padding:0 ",Object(F.a)(1),";"),Be=Object(h.a)(B.f,{target:"e12tl7g25",label:"IncidentPanelItem"})("font-size:",(function(e){return e.theme.fontSizeMedium}),";padding:",Object(F.a)(1.5)," ",Object(F.a)(2)," ",Object(F.a)(1.5)," 0;"),Ve=qe;function _e(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Qe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?_e(Object(r),!0).forEach((function(t){s()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_e(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Fe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=m()(e);if(t){var a=m()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return O()(this,r)}}var Ue="https://docs.sentry.io/workflow/alerts-notifications/alerts/?_ga=2.21848383.580096147.1592364314-1444595810.1582160976";function We(e){return["open","closed"].includes(e)?e:"open"}var Ye=function(e){p()(n,e);var t,r=Fe(n);function n(){return u()(this,n),r.apply(this,arguments)}return b()(n,[{key:"getEndpoints",value:function(){var e=this.props,t=e.params,r=e.location.query,n=We(r.status);return[["incidentList","/organizations/".concat(t&&t.orgId,"/incidents/"),{query:Qe(Qe({},r),{},{status:n})}]]}},{key:"onLoadAllEndpointsSuccess",value:(t=o()(a.a.mark((function e(){var t,r,n,i,o,c,s,l,u;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=this.state.incidentList)&&0===t.length){e.next=4;break}return this.setState({hasAlertRule:!0,firstVisitShown:!1}),e.abrupt("return");case 4:return this.setState({loading:!0}),r=this.props,n=r.params,i=r.location,o=r.organization,e.next=8,this.api.requestPromise("/organizations/".concat(null==n?void 0:n.orgId,"/alert-rules/"),{method:"GET",query:i.query});case 8:if(c=e.sent,!(s=c.length>0)){e.next=13;break}return this.setState({hasAlertRule:s,firstVisitShown:!1,loading:!1}),e.abrupt("return");case 13:return e.next=15,Object(z.a)(this.api,{organizationId:o.id,feature:"alert_stream"});case 15:l=e.sent,(u=!(null!=l&&l.dismissedTime))&&Object(z.b)(this.api,{feature:"alert_stream",organizationId:o.id,status:"dismissed"}),this.setState({hasAlertRule:s,firstVisitShown:u,loading:!1});case 19:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"tryRenderOnboarding",value:function(){var e=this.state.firstVisitShown,t=this.props.organization;if(!e)return null;var r=Object(K.f)(v.a.Fragment,null,Object(K.f)(R.b,{size:"small",external:!0,href:Ue},Object(Q.b)("View Features")),Object(K.f)(D.b,{organization:t,iconProps:{size:"xs"},size:"small",priority:"primary",referrer:"alert_stream"},Object(Q.b)("Create Alert Rule")));return Object(K.f)(te,{actions:r})}},{key:"tryRenderEmpty",value:function(){var e=this.state,t=e.hasAlertRule,r=e.incidentList,n=We(this.props.location.query.status);return!r||r.length>0?null:Object(K.f)(H.a,{size:"medium",icon:Object(K.f)(_.i,{isCircled:!0,size:"48"}),title:t?"open"===n?Object(Q.b)("No unresolved metric alerts in the selected projects."):Object(Q.b)("No resolved metric alerts in the selected projects."):Object(Q.b)("No metric alert rules exist for the selected projects."),description:Object(Q.c)("Learn more about [link:Metric Alerts]",{link:Object(K.f)(L.a,{href:Ue})})})}},{key:"renderLoading",value:function(){return this.renderBody()}},{key:"renderList",value:function(){var e,t,r=this.state,n=r.loading,a=r.incidentList,i=r.incidentListPageLinks,o=r.hasAlertRule,c=this.props.params.orgId,s=new Set(k()(null==a?void 0:a.map((function(e){return e.projects})))),l=!(!a||0!==a.length||void 0!==o),u=n||l,f=We(this.props.location.query.status);return Object(K.f)(v.a.Fragment,null,null!==(e=this.tryRenderOnboarding())&&void 0!==e?e:Object(K.f)(B.a,null,!n&&Object(K.f)(Je,null,Object(K.f)(Ae,{status:f},Object(K.f)(Ge,{status:f},Object(K.f)("div",null,Object(Q.b)("Alert")),"open"===f&&Object(K.f)("div",null,Object(Q.b)("Graph"))),Object(K.f)("div",null,Object(Q.b)("Project")),Object(K.f)("div",null,Object(Q.b)("Triggered")),"closed"===f&&Object(K.f)("div",null,Object(Q.b)("Duration")),"closed"===f&&Object(K.f)("div",null,Object(Q.b)("Resolved")))),u?Object(K.f)(C.default,null):null!==(t=this.tryRenderEmpty())&&void 0!==t?t:Object(K.f)(B.c,null,Object(K.f)(W.a,{orgId:c,slugs:Array.from(s)},(function(e){var t=e.initiallyLoaded,r=e.projects;return a.map((function(e){return Object(K.f)(Ve,{key:e.id,projectsLoaded:t,projects:r,incident:e,orgId:c,filteredStatus:f})}))})))),Object(K.f)(T.a,{pageLinks:i}))}},{key:"renderBody",value:function(){var e=this.props,t=e.params,r=e.location,n=e.organization,a=e.router,i=r.pathname,o=r.query,c=t.orgId,s=x()(Qe(Qe({},o),{},{status:"open"}),"cursor"),l=x()(Qe(Qe({},o),{},{status:"closed"}),"cursor"),u=We(o.status);return Object(K.f)(V.a,{title:Object(Q.b)("Alerts"),objSlug:c},Object(K.f)(N.a,{organization:n,showDateSelector:!1},Object(K.f)(M.a,{organization:n,router:a,activeTab:"stream"}),Object(K.f)(E.a,null,Object(K.f)(E.f,{fullWidth:!0},!this.tryRenderOnboarding()&&Object(K.f)(Me,{merged:!0,active:u},Object(K.f)(R.b,{to:{pathname:i,query:s},barId:"open",size:"small"},Object(Q.b)("Unresolved")),Object(K.f)(R.b,{to:{pathname:i,query:l},barId:"closed",size:"small"},Object(Q.b)("Resolved"))),this.renderList()))))}}]),n}(I.a),He=function(e){p()(r,e);var t=Fe(r);function r(){return u()(this,r),t.apply(this,arguments)}return b()(r,[{key:"componentDidMount",value:function(){this.trackView()}},{key:"componentDidUpdate",value:function(e){var t,r;(null===(t=e.location.query)||void 0===t?void 0:t.status)!==(null===(r=this.props.location.query)||void 0===r?void 0:r.status)&&this.trackView()}},{key:"trackView",value:function(){var e=this.props,t=e.location,r=e.organization,n=We(t.query.status);Object(U.d)({eventKey:"alert_stream.viewed",eventName:"Alert Stream: Viewed",organization_id:r.id,status:n})}},{key:"renderNoAccess",value:function(){return Object(K.f)(E.a,null,Object(K.f)(E.f,{fullWidth:!0},Object(K.f)(A.b,{type:"warning"},Object(Q.b)("You don't have access to this feature"))))}},{key:"render",value:function(){var e=this.props.organization;return Object(K.f)(P.a,{features:["organizations:incidents"],organization:e,hookName:"feature-disabled:alerts-page",renderDisabled:this.renderNoAccess},Object(K.f)(Ye,this.props))}}]),r}(v.a.Component);He.displayName="IncidentsListContainer";var Me=Object(h.a)(q.a,{target:"ebw9n8a0",label:"StyledButtonBar"})("width:100px;margin-bottom:",Object(F.a)(1),";"),Ge=Object(h.a)(Ie,{target:"ebw9n8a1",label:"PaddedTitleAndSparkLine"})("padding-left:",Object(F.a)(2),";"),Je=Object(h.a)(B.e,{target:"ebw9n8a2",label:"StyledPanelHeader"})("padding:",Object(F.a)(1.5)," ",Object(F.a)(2)," ",Object(F.a)(1.5)," 0;");t.default=Object(Y.a)(He)}}]);
//# sourceMappingURL=AlertsList.js.map