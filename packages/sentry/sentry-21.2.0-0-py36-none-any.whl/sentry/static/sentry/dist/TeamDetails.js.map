{"version":3,"sources":["webpack:///./app/components/sentryDocumentTitle.tsx","webpack:///./app/utils/recreateRoute.tsx","webpack:///./app/actionCreators/teams.tsx","webpack:///./app/utils/withTeams.tsx","webpack:///./app/views/settings/organizationTeams/teamDetails.tsx"],"names":["SentryDocumentTitle","props","_title","title","objSlug","children","recreateRoute","to","options","lastRootIndex","routeIndex","routes","params","location","stepBack","paths","map","path","indexOf","findLastIndex","slice","baseRoute","search","hash","fullRoute","join","replaceRouterParams","doCallback","name","args","callIfFunction","fetchTeamDetails","api","TeamActions","fetchDetails","teamId","request","orgId","success","data","fetchDetailsSuccess","error","fetchDetailsError","updateTeamSuccess","updateSuccess","updateTeam","endpoint","update","method","updateError","joinTeam","memberId","id","uniqueId","leaveTeam","createTeam","team","requestPromise","then","createTeamSuccess","addSuccessMessage","tct","slug","organization","err","createTeamError","addErrorMessage","removeTeam","removeTeamSuccess","removeTeamError","withTeams","WrappedComponent","createReactClass","displayName","getDisplayName","mixins","Reflux","listenTo","TeamStore","getInitialState","teams","getAll","onTeamUpdate","this","setState","render","state","TeamDetails","handleRequestAccess","requesting","fetchData","loading","onTeamChange","browserHistory","replace","getBySlug","initialized","prevProps","isEqual","setActiveTeam","find","item","hasAccess","type","RequestAccessWrapper","teamSlug","disabled","isPending","size","onClick","t","onRetry","routePrefix","hideAvatar","avatarSize","underlined","React","isValidElement","cloneElement","Component","withApi"],"mappings":"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","file":"TeamDetails.js","sourcesContent":["import React, {FunctionComponent} from 'react';\nimport DocumentTitle from 'react-document-title';\n\ntype DocumentTitleProps = {\n  // Main page title\n  title: string;\n  // Organization or project slug to give title some context\n  objSlug: string;\n  children?: React.ReactNode;\n};\n\nconst SentryDocumentTitle: FunctionComponent<DocumentTitleProps> = (\n  props: DocumentTitleProps\n) => {\n  const _title = `${props.title} - ${props.objSlug} - Sentry`;\n  return <DocumentTitle title={_title}>{props.children}</DocumentTitle>;\n};\n\nexport default SentryDocumentTitle;\n","import {Location} from 'history';\nimport findLastIndex from 'lodash/findLastIndex';\n\nimport replaceRouterParams from 'app/utils/replaceRouterParams';\nimport {RouteWithName} from 'app/views/settings/components/settingsBreadcrumb/types';\n\ntype Options = {\n  routes: RouteWithName[];\n\n  // parameters to replace any route string parameters (e.g. if route is `:orgId`,\n  // params should have `{orgId: slug}`\n  params: {[key: string]: string | undefined};\n\n  /**\n   * The number of routes to to pop off of `routes\n   * Must be < 0\n   *\n   * There's no ts type for negative numbers so we are arbitrarily specifying -1-9\n   */\n  stepBack?: -1 | -2 | -3 | -4 | -5 | -6 | -7 | -8 | -9;\n  location?: Location;\n};\n\n/**\n * Given a route object or a string and a list of routes + params from router, this will attempt to recreate a location string while replacing url params.\n * Can additionally specify the number of routes to move back\n *\n * See tests for examples\n */\nexport default function recreateRoute(\n  to: string | RouteWithName,\n  options: Options\n): string {\n  const {routes, params, location, stepBack} = options;\n  const paths = routes.map(({path}) => path || '');\n  let lastRootIndex: number;\n  let routeIndex: number | undefined;\n\n  // TODO(ts): typescript things\n  if (typeof to !== 'string') {\n    routeIndex = routes.indexOf(to) + 1;\n    lastRootIndex = findLastIndex(paths.slice(0, routeIndex), path => path[0] === '/');\n  } else {\n    lastRootIndex = findLastIndex(paths, path => path[0] === '/');\n  }\n\n  let baseRoute = paths.slice(lastRootIndex, routeIndex);\n\n  if (typeof stepBack !== 'undefined') {\n    baseRoute = baseRoute.slice(0, stepBack);\n  }\n\n  const search = location?.search ?? '';\n  const hash = location?.hash ?? '';\n\n  const fullRoute = `${baseRoute.join('')}${\n    typeof to !== 'string' ? '' : to\n  }${search}${hash}`;\n\n  return replaceRouterParams(fullRoute, params);\n}\n","import {addErrorMessage, addSuccessMessage} from 'app/actionCreators/indicator';\nimport TeamActions from 'app/actions/teamActions';\nimport {Client} from 'app/api';\nimport {tct} from 'app/locale';\nimport {Team} from 'app/types';\nimport {callIfFunction} from 'app/utils/callIfFunction';\nimport {uniqueId} from 'app/utils/guid';\n\ntype CallbackOptions = {\n  success?: Function;\n  error?: Function;\n};\n\nconst doCallback = (\n  params: CallbackOptions = {},\n  name: keyof CallbackOptions,\n  ...args: any[]\n) => {\n  callIfFunction(params[name], ...args);\n};\n\n/**\n * Note these are both slugs\n */\ntype OrgSlug = {orgId: string};\ntype OrgAndTeamSlug = OrgSlug & {teamId: string};\n\ntype TeamData = {data: Team};\n\n/**\n * This is the actual internal id, not username or email\n */\ntype MemberId = {memberId: string};\n\n// Fetch teams for org\nexport function fetchTeams(api: Client, params: OrgSlug, options: CallbackOptions) {\n  TeamActions.fetchAll(params.orgId);\n  return api.request(`/teams/${params.orgId}/`, {\n    success: data => {\n      TeamActions.fetchAllSuccess(params.orgId, data);\n      doCallback(options, 'success', data);\n    },\n    error: error => {\n      TeamActions.fetchAllError(params.orgId, error);\n      doCallback(options, 'error', error);\n    },\n  });\n}\n\nexport function fetchTeamDetails(\n  api: Client,\n  params: OrgAndTeamSlug,\n  options?: CallbackOptions\n) {\n  TeamActions.fetchDetails(params.teamId);\n  return api.request(`/teams/${params.orgId}/${params.teamId}/`, {\n    success: data => {\n      TeamActions.fetchDetailsSuccess(params.teamId, data);\n      doCallback(options, 'success', data);\n    },\n    error: error => {\n      TeamActions.fetchDetailsError(params.teamId, error);\n      doCallback(options, 'error', error);\n    },\n  });\n}\n\nexport function updateTeamSuccess(teamId: OrgAndTeamSlug['teamId'], data: Team) {\n  TeamActions.updateSuccess(teamId, data);\n}\n\nexport function updateTeam(\n  api: Client,\n  params: OrgAndTeamSlug & TeamData,\n  options: CallbackOptions\n) {\n  const endpoint = `/teams/${params.orgId}/${params.teamId}/`;\n  TeamActions.update(params.teamId, params.data);\n\n  return api.request(endpoint, {\n    method: 'PUT',\n    data: params.data,\n    success: data => {\n      updateTeamSuccess(params.teamId, data);\n      doCallback(options, 'success', data);\n    },\n    error: error => {\n      TeamActions.updateError(params.teamId, error);\n      doCallback(options, 'error', error);\n    },\n  });\n}\n\nexport function joinTeam(\n  api: Client,\n  params: OrgAndTeamSlug & Partial<MemberId>,\n  options: CallbackOptions\n) {\n  const endpoint = `/organizations/${params.orgId}/members/${\n    params.memberId ?? 'me'\n  }/teams/${params.teamId}/`;\n  const id = uniqueId();\n\n  TeamActions.update(id, params.teamId);\n\n  return api.request(endpoint, {\n    method: 'POST',\n    success: data => {\n      TeamActions.updateSuccess(params.teamId, data);\n      doCallback(options, 'success', data);\n    },\n    error: error => {\n      TeamActions.updateError(id, params.teamId, error);\n      doCallback(options, 'error', error);\n    },\n  });\n}\n\nexport function leaveTeam(\n  api: Client,\n  params: OrgAndTeamSlug & Partial<MemberId>,\n  options: CallbackOptions\n) {\n  const endpoint = `/organizations/${params.orgId}/members/${\n    params.memberId || 'me'\n  }/teams/${params.teamId}/`;\n  const id = uniqueId();\n\n  TeamActions.update(id, params.teamId);\n\n  return api.request(endpoint, {\n    method: 'DELETE',\n    success: data => {\n      TeamActions.updateSuccess(params.teamId, data);\n      doCallback(options, 'success', data);\n    },\n    error: error => {\n      TeamActions.updateError(id, params.teamId, error);\n      doCallback(options, 'error', error);\n    },\n  });\n}\n\nexport function createTeam(api: Client, team: Pick<Team, 'slug'>, params: OrgSlug) {\n  TeamActions.createTeam(team);\n\n  return api\n    .requestPromise(`/organizations/${params.orgId}/teams/`, {\n      method: 'POST',\n      data: team,\n    })\n    .then(\n      data => {\n        TeamActions.createTeamSuccess(data);\n        addSuccessMessage(\n          tct('[team] has been added to the [organization] organization', {\n            team: `#${data.slug}`,\n            organization: params.orgId,\n          })\n        );\n        return data;\n      },\n      err => {\n        TeamActions.createTeamError(team.slug, err);\n        addErrorMessage(\n          tct('Unable to create [team] in the [organization] organization', {\n            team: `#${team.slug}`,\n            organization: params.orgId,\n          })\n        );\n        throw err;\n      }\n    );\n}\n\nexport function removeTeam(api: Client, params: OrgAndTeamSlug) {\n  TeamActions.removeTeam(params.teamId);\n\n  return api\n    .requestPromise(`/teams/${params.orgId}/${params.teamId}/`, {\n      method: 'DELETE',\n    })\n    .then(\n      data => {\n        TeamActions.removeTeamSuccess(params.teamId, data);\n        addSuccessMessage(\n          tct('[team] has been removed from the [organization] organization', {\n            team: `#${params.teamId}`,\n            organization: params.orgId,\n          })\n        );\n        return data;\n      },\n      err => {\n        TeamActions.removeTeamError(params.teamId, err);\n        addErrorMessage(\n          tct('Unable to remove [team] from the [organization] organization', {\n            team: `#${params.teamId}`,\n            organization: params.orgId,\n          })\n        );\n        throw err;\n      }\n    );\n}\n","import React from 'react';\nimport createReactClass from 'create-react-class';\nimport Reflux from 'reflux';\n\nimport TeamStore from 'app/stores/teamStore';\nimport {Team} from 'app/types';\nimport getDisplayName from 'app/utils/getDisplayName';\n\ntype InjectedTeamsProps = {\n  teams: Team[];\n};\n\ntype State = {\n  teams: Team[];\n};\n\n/**\n * Higher order component that uses TeamStore and provides a list of teams\n */\nconst withTeams = <P extends InjectedTeamsProps>(\n  WrappedComponent: React.ComponentType<P>\n) =>\n  createReactClass<Omit<P, keyof InjectedTeamsProps>, State>({\n    displayName: `withTeams(${getDisplayName(WrappedComponent)})`,\n    mixins: [Reflux.listenTo(TeamStore, 'onTeamUpdate') as any],\n\n    getInitialState() {\n      return {\n        teams: TeamStore.getAll(),\n      };\n    },\n\n    onTeamUpdate() {\n      this.setState({\n        teams: TeamStore.getAll(),\n      });\n    },\n    render() {\n      return (\n        <WrappedComponent {...(this.props as P)} teams={this.state.teams as Team[]} />\n      );\n    },\n  });\n\nexport default withTeams;\n","import React from 'react';\nimport {browserHistory, RouteComponentProps} from 'react-router';\nimport styled from '@emotion/styled';\nimport isEqual from 'lodash/isEqual';\n\nimport {addErrorMessage, addSuccessMessage} from 'app/actionCreators/indicator';\nimport {fetchTeamDetails, joinTeam} from 'app/actionCreators/teams';\nimport {Client} from 'app/api';\nimport Alert from 'app/components/alert';\nimport Button from 'app/components/button';\nimport IdBadge from 'app/components/idBadge';\nimport ListLink from 'app/components/links/listLink';\nimport LoadingError from 'app/components/loadingError';\nimport LoadingIndicator from 'app/components/loadingIndicator';\nimport NavTabs from 'app/components/navTabs';\nimport SentryDocumentTitle from 'app/components/sentryDocumentTitle';\nimport {t, tct} from 'app/locale';\nimport TeamStore from 'app/stores/teamStore';\nimport {Team} from 'app/types';\nimport recreateRoute from 'app/utils/recreateRoute';\nimport withApi from 'app/utils/withApi';\nimport withTeams from 'app/utils/withTeams';\n\ntype Props = {\n  api: Client;\n  teams: Team[];\n  children: React.ReactNode;\n} & RouteComponentProps<{orgId: string; teamId: string}, {}>;\n\ntype State = {\n  loading: boolean;\n  error: boolean;\n  requesting: boolean;\n  team: Team | null;\n};\n\nclass TeamDetails extends React.Component<Props, State> {\n  state = this.getInitialState();\n\n  getInitialState() {\n    const team = TeamStore.getBySlug(this.props.params.teamId);\n\n    return {\n      loading: !TeamStore.initialized,\n      error: false,\n      requesting: false,\n      team,\n    };\n  }\n\n  componentDidUpdate(prevProps: Props) {\n    const {params} = this.props;\n\n    if (\n      prevProps.params.teamId !== params.teamId ||\n      prevProps.params.orgId !== params.orgId\n    ) {\n      this.fetchData();\n    }\n    if (!isEqual(this.props.teams, prevProps.teams)) {\n      this.setActiveTeam();\n    }\n  }\n\n  setActiveTeam() {\n    const {teamId} = this.props.params;\n    const team = this.props.teams?.find((item: Team) => item.id === teamId) ?? null;\n    const loading = !TeamStore.initialized;\n    const error = !loading && !team;\n\n    this.setState({team, loading, error});\n  }\n\n  handleRequestAccess = () => {\n    const {api, params} = this.props;\n    const {team} = this.state;\n    if (!team) {\n      return;\n    }\n\n    this.setState({\n      requesting: true,\n    });\n\n    joinTeam(\n      api,\n      {\n        orgId: params.orgId,\n        teamId: team.slug,\n      },\n      {\n        success: () => {\n          addSuccessMessage(\n            tct('You have requested access to [team]', {\n              team: `#${team.slug}`,\n            })\n          );\n          this.setState({\n            requesting: false,\n          });\n        },\n        error: () => {\n          addErrorMessage(\n            tct('Unable to request access to [team]', {\n              team: `#${team.slug}`,\n            })\n          );\n          this.setState({\n            requesting: false,\n          });\n        },\n      }\n    );\n  };\n\n  fetchData = () => {\n    this.setState({\n      loading: true,\n      error: false,\n    });\n    fetchTeamDetails(this.props.api, this.props.params);\n  };\n\n  onTeamChange = (data: Team) => {\n    const team = this.state.team;\n    if (data.slug !== team?.slug) {\n      const orgId = this.props.params.orgId;\n      browserHistory.replace(`/organizations/${orgId}/teams/${data.slug}/settings/`);\n    } else {\n      this.setState({\n        team: {\n          ...team,\n          ...data,\n        },\n      });\n    }\n  };\n\n  render() {\n    const {params, routes, children} = this.props;\n    const {team, loading, requesting, error} = this.state;\n\n    if (loading) {\n      return <LoadingIndicator />;\n    }\n    if (!team || !team.hasAccess) {\n      return (\n        <Alert type=\"warning\">\n          {team ? (\n            <RequestAccessWrapper>\n              {tct('You do not have access to the [teamSlug] team.', {\n                teamSlug: <strong>{`#${team.slug}`}</strong>,\n              })}\n              <Button\n                disabled={requesting || team.isPending}\n                size=\"small\"\n                onClick={this.handleRequestAccess}\n              >\n                {team.isPending ? t('Request Pending') : t('Request Access')}\n              </Button>\n            </RequestAccessWrapper>\n          ) : (\n            <div>{t('You do not have access to this team.')}</div>\n          )}\n        </Alert>\n      );\n    }\n    if (error) {\n      return <LoadingError onRetry={this.fetchData} />;\n    }\n\n    const routePrefix = recreateRoute('', {routes, params, stepBack: -1}); //`/organizations/${orgId}/teams/${teamId}`;\n    return (\n      <div>\n        <SentryDocumentTitle title={t('Team Details')} objSlug={params.orgId} />\n        <h3>\n          <IdBadge hideAvatar team={team} avatarSize={36} />\n        </h3>\n\n        <NavTabs underlined>\n          <ListLink to={`${routePrefix}members/`}>{t('Members')}</ListLink>\n          <ListLink to={`${routePrefix}projects/`}>{t('Projects')}</ListLink>\n          <ListLink to={`${routePrefix}settings/`}>{t('Settings')}</ListLink>\n        </NavTabs>\n\n        {React.isValidElement(children) &&\n          React.cloneElement(children, {\n            team,\n            onTeamChange: this.onTeamChange,\n          })}\n      </div>\n    );\n  }\n}\n\nexport default withApi(withTeams(TeamDetails));\n\nconst RequestAccessWrapper = styled('div')`\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n`;\n"],"sourceRoot":""}