(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([[3262],{28417:function(e,t,n){"use strict";n(50808);var o=n(33367),r=n(93592),a=n(87156),i={getTabbableNodes:function(e){var t=[];return this._collectTabbableNodes(e,t)?r.H._sortByTabIndex(t):t},_collectTabbableNodes:function(e,t){if(e.nodeType!==Node.ELEMENT_NODE||!r.H._isVisible(e))return!1;var n,o=e,i=r.H._normalizedTabIndex(o),l=i>0;i>=0&&t.push(o),n="content"===o.localName||"slot"===o.localName?(0,a.vz)(o).getDistributedNodes():(0,a.vz)(o.shadowRoot||o.root||o).children;for(var c=0;c<n.length;c++)l=this._collectTabbableNodes(n[c],t)||l;return l}};function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=f(e);if(t){var r=f(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return p(this,n)}}function p(e,t){return!t||"object"!==l(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d=customElements.get("paper-dialog"),m={get _focusableNodes(){return i.getTabbableNodes(this)}},_=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(n,e);var t=u(n);function n(){return c(this,n),t.apply(this,arguments)}return n}((0,o.P)([m],d));customElements.define("ha-paper-dialog",_)},3262:function(e,t,n){"use strict";n.r(t);n(53918),n(22626);var o=n(50856),r=n(28426),a=(n(28417),n(31206),n(68331),n(4940),n(11052)),i=n(1265);n(36436);function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(){var e=function(e,t){t||(t=e.slice(0));return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(['\n      <style include="ha-style-dialog">\n        .error {\n          color: red;\n        }\n        ha-paper-dialog {\n          max-width: 500px;\n        }\n        h2 {\n          white-space: normal;\n        }\n        ha-markdown {\n          --markdown-svg-background-color: white;\n          --markdown-svg-color: black;\n          display: block;\n          margin: 0 auto;\n        }\n        ha-markdown a {\n          color: var(--primary-color);\n        }\n        .init-spinner {\n          padding: 10px 100px 34px;\n          text-align: center;\n        }\n        .submit-spinner {\n          margin-right: 16px;\n        }\n      </style>\n      <ha-paper-dialog\n        id="dialog"\n        with-backdrop=""\n        opened="{{_opened}}"\n        on-opened-changed="_openedChanged"\n      >\n        <h2>\n          <template is="dom-if" if="[[_equals(_step.type, \'abort\')]]">\n            [[localize(\'ui.panel.profile.mfa_setup.title_aborted\')]]\n          </template>\n          <template is="dom-if" if="[[_equals(_step.type, \'create_entry\')]]">\n            [[localize(\'ui.panel.profile.mfa_setup.title_success\')]]\n          </template>\n          <template is="dom-if" if="[[_equals(_step.type, \'form\')]]">\n            [[_computeStepTitle(localize, _step)]]\n          </template>\n        </h2>\n        <paper-dialog-scrollable>\n          <template is="dom-if" if="[[_errorMsg]]">\n            <div class="error">[[_errorMsg]]</div>\n          </template>\n          <template is="dom-if" if="[[!_step]]">\n            <div class="init-spinner">\n              <ha-circular-progress active></ha-circular-progress>\n            </div>\n          </template>\n          <template is="dom-if" if="[[_step]]">\n            <template is="dom-if" if="[[_equals(_step.type, \'abort\')]]">\n              <ha-markdown\n                allowsvg\n                breaks\n                content="[[_computeStepAbortedReason(localize, _step)]]"\n              ></ha-markdown>\n            </template>\n\n            <template is="dom-if" if="[[_equals(_step.type, \'create_entry\')]]">\n              <p>\n                [[localize(\'ui.panel.profile.mfa_setup.step_done\', \'step\',\n                _step.title)]]\n              </p>\n            </template>\n\n            <template is="dom-if" if="[[_equals(_step.type, \'form\')]]">\n              <template\n                is="dom-if"\n                if="[[_computeStepDescription(localize, _step)]]"\n              >\n                <ha-markdown\n                  allowsvg\n                  breaks\n                  content="[[_computeStepDescription(localize, _step)]]"\n                ></ha-markdown>\n              </template>\n\n              <ha-form\n                data="{{_stepData}}"\n                schema="[[_step.data_schema]]"\n                error="[[_step.errors]]"\n                compute-label="[[_computeLabelCallback(localize, _step)]]"\n                compute-error="[[_computeErrorCallback(localize, _step)]]"\n              ></ha-form>\n            </template>\n          </template>\n        </paper-dialog-scrollable>\n        <div class="buttons">\n          <template is="dom-if" if="[[_equals(_step.type, \'abort\')]]">\n            <mwc-button on-click="_flowDone"\n              >[[localize(\'ui.panel.profile.mfa_setup.close\')]]</mwc-button\n            >\n          </template>\n          <template is="dom-if" if="[[_equals(_step.type, \'create_entry\')]]">\n            <mwc-button on-click="_flowDone"\n              >[[localize(\'ui.panel.profile.mfa_setup.close\')]]</mwc-button\n            >\n          </template>\n          <template is="dom-if" if="[[_equals(_step.type, \'form\')]]">\n            <template is="dom-if" if="[[_loading]]">\n              <div class="submit-spinner">\n                <ha-circular-progress active></ha-circular-progress>\n              </div>\n            </template>\n            <template is="dom-if" if="[[!_loading]]">\n              <mwc-button on-click="_submitStep"\n                >[[localize(\'ui.panel.profile.mfa_setup.submit\')]]</mwc-button\n              >\n            </template>\n          </template>\n        </div>\n      </ha-paper-dialog>\n    ']);return c=function(){return e},e}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function p(e,t,n){return(p="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=_(e);if(t){var r=_(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return m(this,n)}}function m(e,t){return!t||"object"!==l(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _(e){return(_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var h=0,y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(i,e);var t,n,r,a=d(i);function i(){return s(this,i),a.apply(this,arguments)}return t=i,r=[{key:"template",get:function(){return(0,o.d)(c())}},{key:"properties",get:function(){return{_hass:Object,_dialogClosedCallback:Function,_instance:Number,_loading:{type:Boolean,value:!1},_errorMsg:String,_opened:{type:Boolean,value:!1},_step:{type:Object,value:null},_stepData:Object}}}],(n=[{key:"ready",value:function(){var e=this;p(_(i.prototype),"ready",this).call(this),this.hass.loadBackendTranslation("mfa_setup","auth"),this.addEventListener("keypress",(function(t){13===t.keyCode&&e._submitStep()}))}},{key:"showDialog",value:function(e){var t=this,n=e.hass,o=e.continueFlowId,r=e.mfaModuleId,a=e.dialogClosedCallback;this.hass=n,this._instance=h++,this._dialogClosedCallback=a,this._createdFromHandler=!!r,this._loading=!0,this._opened=!0;var i=o?this.hass.callWS({type:"auth/setup_mfa",flow_id:o}):this.hass.callWS({type:"auth/setup_mfa",mfa_module_id:r}),l=this._instance;i.then((function(e){l===t._instance&&(t._processStep(e),t._loading=!1,setTimeout((function(){return t.$.dialog.center()}),0))}))}},{key:"_submitStep",value:function(){var e=this;this._loading=!0,this._errorMsg=null;var t=this._instance;this.hass.callWS({type:"auth/setup_mfa",flow_id:this._step.flow_id,user_input:this._stepData}).then((function(n){t===e._instance&&(e._processStep(n),e._loading=!1)}),(function(t){e._errorMsg=t&&t.body&&t.body.message||"Unknown error occurred",e._loading=!1}))}},{key:"_processStep",value:function(e){e.errors||(e.errors={}),this._step=e,0===Object.keys(e.errors).length&&(this._stepData={})}},{key:"_flowDone",value:function(){this._opened=!1;var e=this._step&&["create_entry","abort"].includes(this._step.type);this._step&&!e&&this._createdFromHandler,this._dialogClosedCallback({flowFinished:e}),this._errorMsg=null,this._step=null,this._stepData={},this._dialogClosedCallback=null}},{key:"_equals",value:function(e,t){return e===t}},{key:"_openedChanged",value:function(e){this._step&&!e.detail.value&&this._flowDone()}},{key:"_computeStepAbortedReason",value:function(e,t){return e("component.auth.mfa_setup.".concat(t.handler,".abort.").concat(t.reason))}},{key:"_computeStepTitle",value:function(e,t){return e("component.auth.mfa_setup.".concat(t.handler,".step.").concat(t.step_id,".title"))||"Setup Multi-factor Authentication"}},{key:"_computeStepDescription",value:function(e,t){var n=["component.auth.mfa_setup.".concat(t.handler,".step.").concat(t.step_id,".description")],o=t.description_placeholders||{};return Object.keys(o).forEach((function(e){n.push(e),n.push(o[e])})),e.apply(void 0,n)}},{key:"_computeLabelCallback",value:function(e,t){return function(n){return e("component.auth.mfa_setup.".concat(t.handler,".step.").concat(t.step_id,".data.").concat(n.name))||n.name}}},{key:"_computeErrorCallback",value:function(e,t){return function(n){return e("component.auth.mfa_setup.".concat(t.handler,".error.").concat(n))||n}}}])&&u(t.prototype,n),r&&u(t,r),i}((0,i.Z)((0,a.I)(r.H3)));customElements.define("ha-mfa-module-setup-flow",y)},36436:function(e,t,n){"use strict";n(21384);var o=n(11654),r=document.createElement("template");r.setAttribute("style","display: none;"),r.innerHTML='<dom-module id="ha-style-dialog">\n<template>\n  <style>\n    '.concat(o.yu.cssText,"\n  </style>\n</template>\n</dom-module>"),document.head.appendChild(r.content)}}]);
//# sourceMappingURL=chunk.83b5bca72150c9f735fc.js.map