(self.webpackChunkjupyterlab_execute_time=self.webpackChunkjupyterlab_execute_time||[]).push([[568],{729:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PLUGIN_NAME=void 0;const n=i(510),s=i(797),o=i(685);t.PLUGIN_NAME="jupyterlab-execute-time";class a extends n.Widget{constructor(e,i){super(),this._cellSlotMap={},this._settings={enabled:!1,highlight:!0,positioning:"left"},this._panel=e,this.updateConnectedCell=this.updateConnectedCell.bind(this),i.load(`${t.PLUGIN_NAME}:settings`).then((e=>{this._updateSettings(e),e.changed.connect(this._updateSettings.bind(this))}),(e=>{console.error(`jupyterlab-execute-time: Could not load settings, so did not active ${t.PLUGIN_NAME}: ${e}`)}))}updateConnectedCell(e,t){t.oldValues.forEach(this._deregisterMetadataChanges.bind(this)),t.newValues.forEach(this._registerMetadataChanges.bind(this))}_registerMetadataChanges(e){if(!(e.id in this._cellSlotMap)){const t=()=>this._cellMetadataChanged(e);this._cellSlotMap[e.id]=t,e.metadata.changed.connect(t)}this._cellMetadataChanged(e,!0)}_deregisterMetadataChanges(e){const t=this._cellSlotMap[e.id];if(t){e.metadata.changed.disconnect(t);const i=this._getCodeCell(e);i&&this._removeExecuteNode(i)}delete this._cellSlotMap[e.id]}_cellMetadataChanged(e,t=!1){const i=this._getCodeCell(e);i?this._updateCodeCell(i,t):"code"===e.type&&console.error(`Could not find code cell for model: ${e}`)}_getCodeCell(e){return"code"===e.type?this._panel.content.widgets.find((t=>t.model===e)):null}_removeExecuteNode(e){const t=e.node.querySelector(".execute-time");t&&t.remove()}_updateCodeCell(e,t){const i=e.model.metadata.get("execution");if(i&&s.JSONExt.isObject(i)){let n=e.node.querySelector(".execute-time");const s="hover"===this._settings.positioning?e.inputArea.node.parentNode:e.inputArea.editorWidget.node;let a;switch(n?n.parentNode!==s&&(n.remove(),s.append(n)):(n=document.createElement("div"),s.append(n)),this._settings.positioning){case"left":a="left";break;case"right":a="right";break;case"hover":a="hover";break;default:console.error(`'${a}' is not a valid type for the setting 'positioning'`)}const l=`execute-time-positioning-${this._settings.positioning}`;n.className=`execute-time ${l}`;const r=i["iopub.status.busy"],d=r?new Date(r):null,c=i["shell.execute_reply.started"]||i["iopub.execute_input"],u=c?new Date(c):null,h=i["shell.execute_reply"],g=h?new Date(h):null;let _="";g?_=`Last executed at ${o.getTimeString(g)} in ${o.getTimeDiff(g,u)}`:u?_=`Execution started at ${o.getTimeString(u)}`:d&&(_=`Execution queued at ${o.getTimeString(d)}`),n.innerText!==_&&(n.innerText=_,!t&&this._settings.highlight&&h&&(n.style.setProperty("animation","executeHighlight 1000ms"),setTimeout((()=>n.style.removeProperty("animation")),1e3)))}else this._removeExecuteNode(e)}_updateSettings(e){this._settings.enabled=e.get("enabled").composite,this._settings.highlight=e.get("highlight").composite,this._settings.positioning=e.get("positioning").composite;const t=this._panel.context.model.cells;if(this._settings.enabled){t.changed.connect(this.updateConnectedCell);for(let e=0;e<t.length;++e)this._registerMetadataChanges(t.get(e))}else{t.changed.disconnect(this.updateConnectedCell);for(let e=0;e<t.length;++e)this._deregisterMetadataChanges(t.get(e))}}}t.default=a},685:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getTimeDiff=t.getTimeString=void 0;const n=i(578);t.getTimeString=e=>n.format(e,"yyy-MM-dd HH:mm:ss"),t.getTimeDiff=(e,t)=>{const i=36e5,s=864e5;let o=n.differenceInMilliseconds(e,t);if(o<1e3)return`${o}ms`;const a=Math.floor(o/s);o%=s;const l=Math.floor(o/i);o%=i;const r=Math.floor(o/6e4);o%=6e4;let d="";return a&&(d+=`${a}d `),(a||l)&&(d+=`${l}h `),(a||l||r)&&(d+=`${r}m `),a||(d+=`${(o/1e3).toFixed(l?0:2)}s`),d.trim()}},568:function(e,t,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0});const a=i(665),l=i(129),r=o(i(729));class d{constructor(e){this._settingRegistry=e}createNew(e,t){return new r.default(e,this._settingRegistry)}}const c={id:r.PLUGIN_NAME,autoStart:!0,requires:[a.INotebookTracker,l.ISettingRegistry],activate:(e,t,i)=>{e.docRegistry.addWidgetExtension("Notebook",new d(i))}};t.default=c}}]);