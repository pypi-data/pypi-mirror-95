

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Example 1: Battle Royal &mdash; turberfield-dialogue 0.30.0 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/turberfield.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Syntax guide" href="syntax.html" />
    <link rel="prev" title="Installation" href="install.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> turberfield-dialogue
          

          
          </a>

          
            
            
              <div class="version">
                0.30.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Example 1: Battle Royal</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#rehearsal">Rehearsal</a></li>
<li class="toctree-l2"><a class="reference internal" href="#script-file">Script file</a></li>
<li class="toctree-l2"><a class="reference internal" href="#references">References</a></li>
<li class="toctree-l2"><a class="reference internal" href="#type">Type</a></li>
<li class="toctree-l2"><a class="reference internal" href="#state">State</a></li>
<li class="toctree-l2"><a class="reference internal" href="#roles">Roles</a></li>
<li class="toctree-l2"><a class="reference internal" href="#repeats">Repeats</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="syntax.html">Syntax guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="cloak.html">Example 2: Cloak of Darkness</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli.html">CLI Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="publishing.html">Publishing</a></li>
<li class="toctree-l1"><a class="reference internal" href="performing.html">Performing</a></li>
<li class="toctree-l1"><a class="reference internal" href="changes.html">Change Log</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">turberfield-dialogue</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Example 1: Battle Royal</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/battle.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="example-1-battle-royal">
<span id="battle"></span><h1>Example 1: Battle Royal<a class="headerlink" href="#example-1-battle-royal" title="Permalink to this headline">¶</a></h1>
<p>Turberfield comes with a couple of examples. We will start with the simplest.
What we learn here will set us up for the more advanced example later.</p>
<p>This is our first encounter with the Turberfield rehearsal tool. We will use
it to preview the action in the first example.</p>
<div class="admonition-what-are-my-options admonition">
<p class="admonition-title">What are my options?</p>
<p>It may be that this is the first time you have launched a Python program from
your computer’s command line. If so, there’s a couple of things to understand
first.</p>
<p>When you launch a command line program, you do so by typing its name. You then
follow that with <em>options</em> which are extra instructions to control the way the
program behaves.</p>
<p>The Turberfield rehearsal tool takes several options. Typing them all out every
time is an annoyance. So the essential ones are stored in a text file called
<em>rehearse.cli</em>. You can pass this file to the program instead and it will take
the options from there. You can add more from the command line at the same time
by typing them afterwards in the usual way.</p>
<p>To instruct the rehearsal tool to load stored options, precede the path to the options
file with a <cite>&#64;</cite> symbol.</p>
</div>
<div class="section" id="rehearsal">
<span id="id1"></span><h2>Rehearsal<a class="headerlink" href="#rehearsal" title="Permalink to this headline">¶</a></h2>
<p>On Linux or MacOSX:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ cd sequences/battle
$ ~/py3.5/bin/turberfield-rehearse @rehearse.cli
</pre></div>
</div>
<p>On Windows 8.1:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">cd</span> <span class="n">sequences</span>\<span class="n">battle</span>
<span class="o">&gt;</span> <span class="n">start</span> <span class="o">%</span><span class="n">USERPROFILE</span><span class="o">%</span>\<span class="n">py3</span><span class="o">.</span><span class="mi">6</span>\<span class="n">Scripts</span>\<span class="n">turberfield</span><span class="o">-</span><span class="n">rehearse</span> <span class="nd">@rehearse</span><span class="o">.</span><span class="n">cli</span>
</pre></div>
</div>
<div class="admonition-you-can-do-this admonition">
<p class="admonition-title">You can do this.</p>
<p>From now on, I’ll assume you know how to operate the command line on your computer.
Further instructions will give the Linux form of commands only, and omit the prompt
character.</p>
</div>
<p>Here’s what you should see in your terminal window. The dialogue is delivered incrementally.
There’s also a sound effect at the appropriate point:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Scratchy
        I hate the way you use me,  Itchy  !

Ol&#39; Rusty Chopper
        **Whack!**

Itchy
        Uuurrggh!

  Itchy.state = 0
</pre></div>
</div>
</div>
<div class="section" id="script-file">
<h2>Script file<a class="headerlink" href="#script-file" title="Permalink to this headline">¶</a></h2>
<p>Let’s take a peek at the file which generates the dialogue. You can open
<cite>sequences/battle/combat.rst</cite> to see it in full. Here’s the gist of
it below.</p>
<div class="highlight-rest notranslate"><div class="highlight"><pre><span></span><span class="p">..</span> <span class="ow">entity</span><span class="p">::</span> FIGHTER_1
   <span class="nc">:states:</span> 1
   <span class="nc">:roles:</span> WEAPON

<span class="p">..</span> <span class="ow">entity</span><span class="p">::</span> FIGHTER_2
   <span class="nc">:types:</span> logic.Animal
   <span class="nc">:states:</span> 1

<span class="p">..</span> <span class="ow">entity</span><span class="p">::</span> WEAPON
   <span class="nc">:types:</span> logic.Tool


<span class="hll"><span class="s">[FIGHTER_1]_</span>
</span><span class="hll">
</span><span class="hll">    I hate the way you use me, |fighter2| !
</span>
<span class="p">..</span> <span class="ow">fx</span><span class="p">::</span> logic slapwhack.wav
   <span class="nc">:offset:</span> 0
   <span class="nc">:duration:</span> 3000
   <span class="nc">:loop:</span> 1

<span class="hll"><span class="s">[WEAPON]_</span>
</span><span class="hll">
</span><span class="hll">    <span class="gs">**Whack!**</span>
</span><span class="hll">
</span><span class="hll"><span class="s">[FIGHTER_2]_</span>
</span><span class="hll">
</span><span class="hll">    Uuurrggh!
</span>
<span class="p">..</span> <span class="ow">property</span><span class="p">::</span> FIGHTER_2.state 0

<span class="p">..</span> <span class="nt">|fighter2|</span> <span class="ow">property</span><span class="p">::</span> FIGHTER_2.name.firstname
</pre></div>
</div>
<p>If you look at the yellow highlighted sections, you’ll see immediately how they correspond
to lines of dialogue. Notice how they aren’t allocated to characters by name. Instead, the
dialogue is written for generic <em>roles</em>. Part of Turberfield’s job is to match characters to
those roles.</p>
<p>The script file also contains other sections which do not correspond to dialogue. They are called
<em>directives</em>. I will explain those in the next section.</p>
<div class="admonition-if-names-be-not-correct admonition">
<p class="admonition-title">If names be not correct…</p>
<p>From now on, I’m going to start being precise in what I call things. I will avoid the words
<em>Actor</em> and <em>Character</em>, since they suggest a human being.</p>
<p>In screenplay any thing, whether animate or inanimate, can have a voice.
So Turberfield calls them <strong>Entities</strong>.</p>
<p>Entities can have <strong>attributes</strong>. An entity with a <em>name</em> attribute is called a <strong>Persona</strong>.
An entity with <em>state</em> attributes is called <strong>Stateful</strong>. In addition to those, you can define
your own <strong>types</strong> for your entities.  So long as their types match, one entity can play the
<strong>role</strong> of another entity.</p>
</div>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<p>Alongside the script file, there is a Python (.py) file.
Python files are called <cite>modules</cite>.
They supply the entities referred to in the script.
You should take a look in detail at <cite>sequences/battle/logic.py</cite>.
Here below are its main features.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">turberfield.dialogue.model</span> <span class="kn">import</span> <span class="n">SceneScript</span>
<span class="kn">from</span> <span class="nn">turberfield.dialogue.types</span> <span class="kn">import</span> <span class="n">Persona</span>
<span class="kn">from</span> <span class="nn">turberfield.dialogue.types</span> <span class="kn">import</span> <span class="n">Stateful</span>


<span class="k">class</span> <span class="nc">Animal</span><span class="p">(</span><span class="n">Stateful</span><span class="p">,</span> <span class="n">Persona</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="k">class</span> <span class="nc">Tool</span><span class="p">(</span><span class="n">Stateful</span><span class="p">,</span> <span class="n">Persona</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="n">references</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">Animal</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Itchy&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">set_state</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
    <span class="n">Animal</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Scratchy&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">set_state</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
    <span class="n">Tool</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Ol&#39; Rusty Chopper&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">set_state</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
<span class="p">]</span>

<span class="n">folder</span> <span class="o">=</span> <span class="n">SceneScript</span><span class="o">.</span><span class="n">Folder</span><span class="p">(</span>
    <span class="n">pkg</span><span class="o">=</span><span class="vm">__name__</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Cartoon battle demo&quot;</span><span class="p">,</span>
    <span class="n">metadata</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">paths</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;combat.rst&quot;</span><span class="p">],</span>
    <span class="n">interludes</span><span class="o">=</span><span class="kc">None</span>
<span class="p">)</span>
</pre></div>
</div>
<p>This file performs five tasks:</p>
<blockquote>
<div><dl class="simple">
<dt>Lines 1 - 5</dt><dd><p>Import what we need from Turberfield.</p>
</dd>
<dt>Lines 8 - 12</dt><dd><p>Define some types which are necessary for the scene.</p>
</dd>
<dt>Lines 14 - 18</dt><dd><p>Create some objects to be referenced by the script.
We also give them a state at the same time.</p>
</dd>
<dt>Lines 20 - 26</dt><dd><p>Declare a folder object which contains our scene script file.
There are several other elements here, and we’ll go into it properly
later.</p>
</dd>
</dl>
</div></blockquote>
</div>
<div class="section" id="type">
<h2>Type<a class="headerlink" href="#type" title="Permalink to this headline">¶</a></h2>
<p>A type is a concept from Python. You can create types with a <cite>class</cite> declaration
in a Python module. In all these examples, we do no more than inherit behaviour
from other base classes, hence the single <cite>pass</cite> instruction in the class
body.</p>
<p>Notice that two of the entity declarations in the script
file have a <cite>:types:</cite> constraint; Fighter 2 has to be some kind of Animal, and
the Weapon a Tool.</p>
</div>
<div class="section" id="state">
<h2>State<a class="headerlink" href="#state" title="Permalink to this headline">¶</a></h2>
<p>The Battle Royal sequence makes use of <cite>state</cite>. Both fighters must be
alive at the beginning of the scene. This is encoded as a simple integer state,
which is set in the Python module when the references are created.</p>
<p>The entity declaration in the script file specifies the state must be 1 in
order for a persona to be cast as one of the fighters in the scene.</p>
<p>A property directive in the scene file zeroes the state of the smitten
fighter. We’ll look in more detail how this works in the <a class="reference internal" href="syntax.html#syntax"><span class="std std-ref">Syntax guide</span></a>.</p>
</div>
<div class="section" id="roles">
<h2>Roles<a class="headerlink" href="#roles" title="Permalink to this headline">¶</a></h2>
<p>By default, Turberfield’s rehearsal proceeds despite any unmatched entities.
The lines will not be voiced for unmatched parts. If you want to be strict
about only playing fully-cast scene files, you can specify that with an option.</p>
<p>In either case, if <em>none</em> of the entities in the scene can be cast, the entire
scene is skipped.</p>
<p>An extra dimension to the casting of entities is the concept of <cite>roles</cite>.
When roles are attached to an entity declaration it means that the
persona which gets cast to play that entity becomes a candidate to
play those other entities too.</p>
<p>In this way, a scene written as a montage of ensemble dialogue could
still be delivered as a monologue were there to be only one persona
available to deliver the lines.</p>
</div>
<div class="section" id="repeats">
<h2>Repeats<a class="headerlink" href="#repeats" title="Permalink to this headline">¶</a></h2>
<p>By default the rehearsal tool runs through the scene just once. To see the
effect of roles in this example, we’ll need the scene to repeat. Launch
the rehearsal again, this time specifying a repetition:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">~/</span><span class="n">py3</span><span class="o">.</span><span class="mi">5</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">turberfield</span><span class="o">-</span><span class="n">rehearse</span> <span class="o">--</span><span class="n">repeat</span><span class="o">=</span><span class="mi">1</span> <span class="nd">@rehearse</span><span class="o">.</span><span class="n">cli</span>
</pre></div>
</div>
<p>And you should see the carnage play out, with one inevitable winner left standing:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Scratchy
      I hate the way you use me,  Itchy  !

Ol&#39; Rusty Chopper
      **Whack!**

Itchy
      Uuurrggh!

    Itchy.state = 0

Ol&#39; Rusty Chopper
      I hate the way you use me,  Scratchy  !

Ol&#39; Rusty Chopper
      **Whack!**

Scratchy
      Uuurrggh!

    Scratchy.state = 0
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="syntax.html" class="btn btn-neutral float-right" title="Syntax guide" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="install.html" class="btn btn-neutral float-left" title="Installation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2017, D Haynes

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>